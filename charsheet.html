<!-- Roll20 character sheet created by Thomas Pohler -->
<!-- for the TTRPG Legends Unbound, created by Kurt Knudsen and co-created by Thomas Pohler -->



<!-- DEVELOPER NOTE: -->
<!-- Variables are stored between sessions via the "name" attribute -->
<!-- As of this writing, no direct JavaScript manipulation is allowed outside of .addClass()/.removeClass()/.toggleClass()/.on() -->





<div id="full_sheet">
    
    
    
    
    
    <!------------>
    <!-- HEADER -->
    <!------------>
    
    <!-- Controls which page is currently active -->
    <input type="hidden" name="attr_sheet_page" value="combat" />
    <div id="page_holder" class="row">
        <button type="action" name="act_combat"><span>Combat</span></button>
        <button type="action" name="act_roleplay"><span>Roleplay</span></button>
        <button type="action" name="act_level"><span>Level-Up</span></button>
        <button type="action" name="act_equipment"><span>Equipment</span></button>
        <button type="action" name="act_cheatsheet"><span>Cheatsheet</span></button>
    </div>





    <!------------------>
    <!-- PAGE: COMBAT -->
    <!------------------>
    <div id="page_combat" class="row">

        <div class="main-page-area">

            <!-- STATS -->
            <div class="container-style main-width">
                <div class="header-row">
                    <button type="action" name="act_stats_collapse" title="Open/Close"></button>
                    <span>Stats</span>
                </div>
                
                <div class="collapsible" id="stats_collapse">
                    <div class="header-hr"></div>

                    <div class="row">
                        <div class="hr"></div>
                        <span class="text-color">CHARACTER</span>
                        <div class="hr"></div>
                    </div>

                    <div class="row">
                        <div class="health-field">
                            <span>Health</span>
                            <input type="number" name="attr_health" placeholder="CURRENT" />
                            <input type="number" name="attr_health_max" placeholder="MAXIMUM" />
                        </div>
                        <div class="mana-field">
                            <span>Mana</span>
                            <input type="number" name="attr_mana" placeholder="CURRENT" />
                            <input type="number" name="attr_mana_max" placeholder="MAXIMUM" />
                        </div>
                        <div class="death-stack-field">
                            <span>Strokes of Fate</span>
                            <input type="number" name="attr_deathstacks" value="3" placeholder="CURRENT" />
                            <input type="number" name="attr_deathstacks_max" value="3" placeholder="MAXIMUM" />
                        </div>
                        
                    </div>

                    <div class="row">
                        <div>
                            <span>Level</span>
                            <input type="number" name="attr_character_level" value="1"/>
                        </div>
                        <div>
                            <span>Gold</span>
                            <input type="number" name="attr_gold" value="0" />
                        </div>
                        <div>
                            <span>Size</span>
                            <input type="text" name="attr_character_size" />
                        </div>
                        <div>
                            <span>Fatigue</span>
                            <input type="number" name="attr_fatigue" value="0" />
                        </div>
                        <div>
                            <span>Rest Points</span>
                            <input type="number" name="attr_rest" value="1" />
                            <input type="text" name="attr_rest_max" readonly="true" value="1 max" />
                        </div>
                    </div>



                    <div class="row top-padding-6px">
                        <div class="hr"></div>
                        <span class="text-color">STATUSES</span>
                        <div class="hr"></div>
                    </div>

                    <div class="row">
                        <div>
                            <span>Status 1</span>
                            <input type="text" name="attr_status1" />
                        </div>
                        <div>
                            <span>Status 2</span>
                            <input type="text" name="attr_status2" />
                        </div>
                        <div>
                            <span>Status 3</span>
                            <input type="text" name="attr_status3" />
                        </div>
                    </div>



                    <div class="row top-padding-6px">
                        <div class="hr"></div>
                        <span class="text-color">EQUIPMENT</span>
                        <div class="hr"></div>
                    </div>

                    <div class="row equipment-row">
                        <div>
                            <span>Armor Loadout</span>
                            <select name="attr_armor_loadout">
                                <option value="0">None</option>
                                <option value="1">Loadout 1</option>
                                <option value="2">Loadout 2</option>
                                <option value="3">Loadout 3</option>
                            </select>
                        </div>
                        <div>
                            <span>Shield Loadout</span>
                            <select name="attr_shield_loadout">
                                <option value="0">None</option>
                                <option value="1">Loadout 1</option>
                                <option value="2">Loadout 2</option>
                                <option value="3">Loadout 3</option>
                            </select>
                        </div>
                        <div>
                            <span>Equip. Slots</span>
                            <input type="number" name="attr_equipslots" value="0" />
                            <input type="number" name="attr_equipslots_max" readonly="true" value="5" />
                        </div>
                        <div>
                            <span>Switch Page</span>
                            <button type="action" name="act_equipment"><span>Equipment</span></button>
                        </div>
                    </div>
                    <div class="row equipment-row">
                        <div class="main-hand">
                            <span>Main Hand</span>
                            <input type="text" name="attr_lefthand" />
                        </div>
                        <div class="off-hand">
                            <span>Offhand</span>
                            <input type="text" name="attr_righthand" />
                        </div>
                        <div class="hands-slot col2 hidden">
                            <span>Hands</span>
                            <input type="text" name="attr_hands" />
                        </div>
                        <div>
                            <span>Two-Handing</span>
                            <input type="checkbox" name="attr_twohanding">
                        </div>
                    </div>



                    <div class="row top-padding-6px">
                        <div class="hr"></div>
                        <span class="text-color">TOLERANCES / WEAKNESSES</span>
                        <div class="hr"></div>
                    </div>

                    <div class="row">
                        <div>
                            <span>Acid</span>
                            <input type="number" readonly="true" value="0" class="acid" name="attr_acid"/>
                        </div>
                        <div>
                            <span>Blast</span>
                            <input type="number" readonly="true" value="0" class="blast" name="attr_blast"/>
                        </div>
                        <div>
                            <span>Cold</span>
                            <input type="number" readonly="true" value="0" class="cold" name="attr_cold"/>
                        </div>
                        <div>
                            <span>Death</span>
                            <input type="number" readonly="true" value="0" class="death" name="attr_death"/>
                        </div>
                        <div>
                            <span>Electric</span>
                            <input type="number" readonly="true" value="0" class="electric" name="attr_electric"/>
                        </div>
                    </div>
                    <div class="row bottom-padding-3px">
                        <div>
                            <span>Fire</span>
                            <input type="number" readonly="true" value="0" class="fire" name="attr_fire"/>
                        </div>
                        <div>
                            <span>Light</span>
                            <input type="number" readonly="true" value="0" class="light" name="attr_light"/>
                        </div>
                        <div>
                            <span>Physical</span>
                            <input type="number" readonly="true" value="0" class="physical" name="attr_physical"/>
                        </div>
                        <div>
                            <span>Poison</span>
                            <input type="number" readonly="true" value="0" class="poison" name="attr_poison"/>
                        </div>
                        <div>
                            <span>Psychic</span>
                            <input type="number" readonly="true" value="0" class="psychic" name="attr_psychic"/>
                        </div>
                    </div>
                    
                    
                    
                    <div class="row top-padding-6px">
                        <div class="hr"></div>
                        <span class="text-color">MOVEMENTS</span>
                        <div class="hr"></div>
                    </div>

                    <div class="row">
                        <div>
                            <span>Walking</span>
                            <input type="number" name="attr_walking" value="5" />
                        </div>
                        <div>
                            <span>Swimming</span>
                            <input type="number" name="attr_swimming" value="3" />
                        </div>
                        <div>
                            <span>Jumping</span>
                            <input type="number" name="attr_jumping" value="3" />
                        </div>
                        <div>
                            <span>Flying</span>
                            <input type="number" name="attr_flying" value="0" />
                        </div>
                        <div>
                            <span>Burrowing</span>
                            <input type="number" name="attr_burrowing" value="0" />
                        </div>
                    </div>
                </div>
            </div>



            <div class="container-style main-width">
                <div class="header-row">
                    <button type="action" name="act_dcdefense_collapse" title="Open/Close"></button>
                    <span>Defense</span>
                </div>
                
                <div class="collapsible" id="dcdefense_collapse">
                    <div class="header-hr"></div>

                    <div class="row">
                        <div>
                            <span>ADVANTAGE</span>
                            <input type="number" name="attr_defense_advantage" value="0" />
                        </div>
                        <div>
                            <span>MODIFIER</span>
                            <input type="number" name="attr_defense_modifier" value="0" />
                        </div>
                        
                        <div>
                            <span>CRIT. RANGE</span>
                            <input type="number" name="attr_defense_minimum" value="20" />
                        </div>
                    </div>

                    <div class="row">
                        <button type="action" name="act_melee_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_melee_defense" readonly="true"/><span>Melee Defense</span></button>
                        <button type="action" name="act_effect_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_effect_defense" readonly="true"/><span>Effect Defense</span></button>
                    </div>
                    <div class="row">
                        <button type="action" name="act_ranged_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_ranged_defense" readonly="true"/><span>Ranged Defense</span></button>
                        <button type="action" name="act_ability_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_ability_defense" readonly="true"/><span>Ability Defense</span></button>
                    </div>
                    <div class="row">
                        <button type="action" name="act_spell_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_spell_defense" readonly="true"/><span>Spellstrike Defense</span></button>
                        <button type="action" name="act_environment_defense" style="width:112px; text-align:center;"><input style="width: 25px !important;" type="number" value="0" name="attr_environment_defense" readonly="true"/><span>Environment Defense</span></button>
                    </div>
                </div>
            </div>
        </div>




        <div class="right_sidebar"> <!-- column 2 of main page -->
            <div id="global_mod_box" class="container-style">
                <span class="text-color">GLOBAL MODS</span>
                <div class="hr"></div>
                <div>
                    <span>ADVANTAGE</span>
                    <input type="number" name="attr_advantage" value="0" />
                </div>
                <div>
                    <span>MODIFIER</span>
                    <input type="number" name="attr_modifier" value="0" />
                </div>
                <div>
                    <span>FD-ONLY ROLL</span>
                    <input type="checkbox" name="attr_hidden_roll">
                </div>
            </div>

            <div id="action_tracker_box" class="container-style">
                <span class="text-color">ACTION TRACKER</span>
                <div class="hr"></div>
                <select name="attr_action_tracker_select">
                    <option>Legend</option>
                    <option>Fodder</option>
                    <option>Elite</option>
                    <option>Boss</option>
                </select>
                <div class="actions legend">
                    <div>
                        <span>MAIN ACTIONS</span>
                        <div class="centered-row">
                            <div>
                                <input type="checkbox">
                                <input type="checkbox">
                            </div>
                        </div>
                    </div>
                    <div>
                        <span>TACTICAL ACTIONS</span>
                        <div class="centered-row">
                            <div>
                                <input type="checkbox">
                                <input type="checkbox">
                            </div>
                        </div>
                    </div>
                    <div>
                        <span>MAIN ATTACK TOKEN</span>
                        <div class="centered-row">
                            <input type="checkbox">
                        </div>
                    </div>
                </div>
                <div class="actions fodder hidden">
                    <div>
                        <span>MAIN ACTIONS</span>
                        <div class="centered-row fodder">
                            <div>
                                <input type="checkbox">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="actions elite hidden">
                    <div>
                        <span>MAIN ACTIONS</span>
                        <div class="centered-row elite">
                            <div>
                                <input type="checkbox">
                                <input type="checkbox">
                            </div>
                        </div>
                    </div>
                </div>
                <div class="actions boss hidden">
                    <div>
                        <span>MAIN ACTIONS</span>
                        <div class="centered-row boss">
                            <div>
                                <input type="checkbox">
                                <input type="checkbox">
                                <input type="checkbox">
                                <input type="checkbox">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>





    <!-------------------->
    <!-- PAGE: ROLEPLAY -->
    <!-------------------->
    <div id="page_roleplay" class="row hidden">
    
        <div class="main-page-area"> <!-- column 1 of main page -->

            <!-- CHARACTER -->
            <div class="container-style main-width">
                <input type="hidden" name="attr_character_collapse" value="0" />
                <div class="header-row">
                    <button type="action" name="act_character_collapse" title="Open/Close"></button>
                    <span>Character</span>
                </div>
                
                <div class="collapsible" id="character_collapse">
                    <div class="header-hr"></div>

                    <div class="row">
                        <div class="col3">
                            <span>NAME</span>
                            <input type="text" name="attr_character_name"/>
                        </div>
                        <div class="col1">
                            <span>LEVEL</span>
                            <input type="number" name="attr_character_level" value="1"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col3">
                            <span>SPECIES</span>
                            <input type="text" name="attr_character_species" />
                        </div>
                        <div class="col1">
                            <span>PLAYER</span>
                            <input type="text" name="attr_character_player" />
                        </div>
                    </div>
                    <div class="row">
                        <div>
                            <span>CLASS(ES)</span>
                            <input type="text" name="attr_character_class" />
                        </div>
                    </div>
                    <div class="row">
                        <div>
                            <span class="accent-text">DESCRIPTION</span>
                            <textarea name="attr_appearance_text"></textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div>
                            <span class="accent-text">KNOWN LANGUAGES</span>
                            <textarea class="short" name="attr_language">Evritung</textarea>
                        </div>
                    </div>
                </div>
            </div>
    
    
    
            <!-- TRAITS -->
            <div class="container-style main-width">
                <div class="header-row">
                    <button type="action" name="act_traits_collapse" title="Open/Close"></button>
                    <span>Traits</span>
                </div>
                
                <div class="collapsible" id="traits_collapse">
                    <div class="header-hr"></div>

                    <div class="row">
                        <div>
                            <span>ADVANTAGE</span>
                            <input type="number" name="attr_trait_advantage" value="0" />
                        </div>
                        <div>
                            <span>MODIFIER</span>
                            <input type="number" name="attr_trait_modifier" value="0" />
                        </div>
                        
                        <div>
                            <span>CRIT. RANGE</span>
                            <input type="number" name="attr_trait_minimum" value="20" />
                        </div>
                    </div>

                    <div class="horizontal-traits">
                        <div class="row">
                            <button type="action" class="agility" name="act_agility"><input style="width: 25px !important;" type="number" value="0" name="attr_agility" readonly="true"/><span>Agility</span></button>
                            <button type="action" class="apothecary" name="act_apothecary"><input style="width: 25px !important;" type="number" value="0" name="attr_apothecary" readonly="true"/><span>Apothecary</span></button>
                            <button type="action" class="bargain" name="act_bargain"><input style="width: 25px !important;" type="number" value="0" name="attr_bargain" readonly="true"/><span>Bargain</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="communication" name="act_communication"><input style="width: 25px !important;" type="number" value="0" name="attr_communication" readonly="true"/><span>Communication</span></button>
                            <button type="action" class="convince" name="act_convince"><input style="width: 25px !important;" type="number" value="0" name="attr_convince" readonly="true"/><span>Convince</span></button>
                            <button type="action" class="engineering" name="act_engineering"><input style="width: 25px !important;" type="number" value="0" name="attr_engineering" readonly="true"/><span>Engineering</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="entertainment" name="act_entertainment"><input style="width: 25px !important;" type="number" value="0" name="attr_entertainment" readonly="true"/><span>Entertainment</span></button>
                            <button type="action" class="etiquette" name="act_etiquette"><input style="width: 25px !important;" type="number" value="0" name="attr_etiquette" readonly="true"/><span>Etiquette</span></button>
                            <button type="action" class="hands" name="act_hands"><input style="width: 25px !important;" type="number" value="0" name="attr_hands" readonly="true"/><span>Hands</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="history" name="act_history"><input style="width: 25px !important;" type="number" value="0" name="attr_history" readonly="true"/><span>History</span></button>
                            <button type="action" class="intuition" name="act_intuition"><input style="width: 25px !important;" type="number" value="0" name="attr_intuition" readonly="true"/><span>Intuition</span></button>
                            <button type="action" class="investigation" name="act_investigation"><input style="width: 25px !important;" type="number" value="0" name="attr_investigation" readonly="true"/><span>Investigation</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="magic" name="act_magic"><input style="width: 25px !important;" type="number" value="0" name="attr_magic" readonly="true"/><span>Magic</span></button>
                            <button type="action" class="might" name="act_might"><input style="width: 25px !important;" type="number" value="0" name="attr_might" readonly="true"/><span>Might</span></button>
                            <button type="action" class="navigation" name="act_navigation"><input style="width: 25px !important;" type="number" value="0" name="attr_navigation" readonly="true"/><span>Navigation</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="observation" name="act_observation"><input style="width: 25px !important;" type="number" value="0" name="attr_observation" readonly="true"/><span>Observation</span></button>
                            <button type="action" class="perseverance" name="act_perseverance"><input style="width: 25px !important;" type="number" value="0" name="attr_perseverance" readonly="true"/><span>Perseverance</span></button>
                            <button type="action" class="religion" name="act_religion"><input style="width: 25px !important;" type="number" value="0" name="attr_religion" readonly="true"/><span>Religion</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="soothe" name="act_soothe"><input style="width: 25px !important;" type="number" value="0" name="attr_soothe" readonly="true"/><span>Soothe</span></button>
                            <button type="action" class="stealth" name="act_stealth"><input style="width: 25px !important;" type="number" value="0" name="attr_stealth" readonly="true"/><span>Stealth</span></button>
                            <button type="action" class="threat" name="act_threat"><input style="width: 25px !important;" type="number" value="0" name="attr_threat" readonly="true"/><span>Threat</span></button>
                        </div>
                        <div class="row bottom-padding-6px">
                            <button class="empty-row-cell"></button>
                            <button type="action" class="wilderness" name="act_wilderness"><input style="width: 25px !important;" type="number" value="0" name="attr_wilderness" readonly="true"/><span>Wilderness</span></button>
                            <button class="empty-row-cell"></button>
                        </div>
                    </div>

                    <div class="vertical-traits hidden">
                        <div class="row">
                            <button type="action" class="agility" name="act_agility"><input style="width: 25px !important;" type="number" value="0" name="attr_agility" readonly="true"/><span>Agility</span></button>
                            <button type="action" class="etiquette" name="act_etiquette"><input style="width: 25px !important;" type="number" value="0" name="attr_etiquette" readonly="true"/><span>Etiquette</span></button>
                            <button type="action" class="observation" name="act_observation"><input style="width: 25px !important;" type="number" value="0" name="attr_observation" readonly="true"/><span>Observation</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="apothecary" name="act_apothecary"><input style="width: 25px !important;" type="number" value="0" name="attr_apothecary" readonly="true"/><span>Apothecary</span></button>
                            <button type="action" class="hands" name="act_hands"><input style="width: 25px !important;" type="number" value="0" name="attr_hands" readonly="true"/><span>Hands</span></button>
                            <button type="action" class="perseverance" name="act_perseverance"><input style="width: 25px !important;" type="number" value="0" name="attr_perseverance" readonly="true"/><span>Perseverance</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="bargain" name="act_bargain"><input style="width: 25px !important;" type="number" value="0" name="attr_bargain" readonly="true"/><span>Bargain</span></button>
                            <button type="action" class="history" name="act_history"><input style="width: 25px !important;" type="number" value="0" name="attr_history" readonly="true"/><span>History</span></button>
                            <button type="action" class="religion" name="act_religion"><input style="width: 25px !important;" type="number" value="0" name="attr_religion" readonly="true"/><span>Religion</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="communication" name="act_communication"><input style="width: 25px !important;" type="number" value="0" name="attr_communication" readonly="true"/><span>Communication</span></button>
                            <button type="action" class="intuition" name="act_intuition"><input style="width: 25px !important;" type="number" value="0" name="attr_intuition" readonly="true"/><span>Intuition</span></button>
                            <button type="action" class="soothe" name="act_soothe"><input style="width: 25px !important;" type="number" value="0" name="attr_soothe" readonly="true"/><span>Soothe</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="convince" name="act_convince"><input style="width: 25px !important;" type="number" value="0" name="attr_convince" readonly="true"/><span>Convince</span></button>
                            <button type="action" class="investigation" name="act_investigation"><input style="width: 25px !important;" type="number" value="0" name="attr_investigation" readonly="true"/><span>Investigation</span></button>
                            <button type="action" class="stealth" name="act_stealth"><input style="width: 25px !important;" type="number" value="0" name="attr_stealth" readonly="true"/><span>Stealth</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="engineering" name="act_engineering"><input style="width: 25px !important;" type="number" value="0" name="attr_engineering" readonly="true"/><span>Engineering</span></button>
                            <button type="action" class="magic" name="act_magic"><input style="width: 25px !important;" type="number" value="0" name="attr_magic" readonly="true"/><span>Magic</span></button>
                            
                            <button type="action" class="threat" name="act_threat"><input style="width: 25px !important;" type="number" value="0" name="attr_threat" readonly="true"/><span>Threat</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="entertainment" name="act_entertainment"><input style="width: 25px !important;" type="number" value="0" name="attr_entertainment" readonly="true"/><span>Entertainment</span></button>
                            <button type="action" class="might" name="act_might"><input style="width: 25px !important;" type="number" value="0" name="attr_might" readonly="true"/><span>Might</span></button>
                            <button type="action" class="wilderness" name="act_wilderness"><input style="width: 25px !important;" type="number" value="0" name="attr_wilderness" readonly="true"/><span>Wilderness</span></button>
                        </div>
                        <div class="row bottom-padding-6px">
                            <button class="empty-row-cell"></button>
                            <button type="action" class="navigation" name="act_navigation"><input style="width: 25px !important;" type="number" value="0" name="attr_navigation" readonly="true"/><span>Navigation</span></button>
                            <button class="empty-row-cell"></button>
                        </div>
                    </div>
                </div>
            </div>
            
            
            
            <!-- FLAWED LEGENDS -->
            <div class="container-style main-width">
                <div class="header-row">
                    <button type="action" name="act_flawedlegend_collapse" title="Open/Close"></button>
                    <span>Development</span>
                </div>
                
                <div class="collapsible" id="flawedlegend_collapse">
                    <div class="header-hr"></div>
                    
                    <div class="centered-row">
                        <span>Lore Points: </span><input type="number" name="attr_lore_points" style="width: 4em !important;"/>
                    </div>
                    
                    <div class="row">
                        <div style="width: 50%;">
                            <span>BACKSTORY</span>
                            <textarea style="width: 220px" rows="4" name="attr_roleplay_backstory"></textarea>
                        </div>
                        <div style="width: 50%;">
                            <span>GOALS</span>
                            <textarea style="width: 220px" rows="4" name="attr_roleplay_goals"></textarea>
                        </div>
                    </div>
                    <div class="row">
                        <div style="width: 50%;">
                            <span>BONDS</span>
                            <textarea style="width: 220px" rows="13" name="attr_roleplay_bonds"></textarea>
                        </div>
                        <div style="width: 50%;">
                            <span>FLAWED LEGENDS</span>
                            <textarea style="width: 220px; height: 120px;" rows="12" name="attr_roleplay_flaws"></textarea>
                            <div style="display: flex;">
                                <span>Current FL Value:</span>
                                <input style="width: 100px !important;" type="number" name="attr_flawed_legend"/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    
    
    
        <div class="right_sidebar"> <!-- column 2 of main page -->
            <div id="global_mod_box" class="container-style">
                <span class="text-color">GLOBAL MODS</span>
                <div class="hr"></div>
                <div>
                    <span>ADVANTAGE</span>
                    <input type="number" name="attr_advantage" value="0" />
                </div>
                <div>
                    <span>MODIFIER</span>
                    <input type="number" name="attr_modifier" value="0" />
                </div>
                <div>
                    <span>FD-ONLY ROLL</span>
                    <input type="checkbox" name="attr_hidden_roll">
                </div>
            </div>
    
            <div id="sheet_settings_box" class="container-style">
                <span class="text-color">SHEET SETTINGS</span>
                <div class="hr"></div>
                <div>
                    <span>TRAIT DIRECTION</span>
                    <select name="attr_settings_traitdirection">
                        <option>Horizontal</option>
                        <option>Vertical</option>
                    </select>
                </div>
                <div id="sheet_color">
                    <span>COLOR</span>
                    <select name="attr_settings_color">
                        <option>Default</option>
                        <option>Red</option>
                        <option>Green</option>
                        <option>Blue</option>
                        <option>Purple</option>
                        <option>Pink</option>
                    </select>
                </div>
            </div>
        </div>
        
    
    
    </div> <!-- end: #page-roleplay -->





    <!----------------->
    <!-- PAGE: LEVEL -->
    <!----------------->
    <div id="page_level" class="hidden">

        <div class="container-style main-width bottom-padding-4px">
            <div class="row">
                <div class="hr"></div>
                <span>ROLEPLAY</span>
                <div class="hr"></div>
            </div>

            <div class="horizontal-traits">
                <div class="row trait-row">
                    <div>
                        <span>Agility</span>
                        <div class="row">
                            <select name="attr_agility_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_agility_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Apothecary</span>
                        <div class="row">
                            <select name="attr_apothecary_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_apothecary_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Bargain</span>
                        <div class="row">
                            <select name="attr_bargain_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_bargain_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Communication</span>
                        <div class="row">
                            <select name="attr_communication_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_communication_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Convince</span>
                        <div class="row">
                            <select name="attr_convince_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_convince_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Engineering</span>
                        <div class="row">
                            <select name="attr_engineering_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_engineering_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Entertainment</span>
                        <div class="row">
                            <select name="attr_entertainment_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_entertainment_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Etiquette</span>
                        <div class="row">
                            <select name="attr_etiquette_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_etiquette_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Hands</span>
                        <div class="row">
                            <select name="attr_hands_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_hands_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>History</span>
                        <div class="row">
                            <select name="attr_history_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_history_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Intuition</span>
                        <div class="row">
                            <select name="attr_intuition_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_intuition_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Investigation</span>
                        <div class="row">
                            <select name="attr_investigation_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_investigation_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Magic</span>
                        <div class="row">
                            <select name="attr_magic_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_magic_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Might</span>
                        <div class="row">
                            <select name="attr_might_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_might_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Navigation</span>
                        <div class="row">
                            <select name="attr_navigation_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_navigation_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Observation</span>
                        <div class="row">
                            <select name="attr_observation_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_observation_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Perseverance</span>
                        <div class="row">
                            <select name="attr_perseverance_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_perseverance_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Religion</span>
                        <div class="row">
                            <select name="attr_religion_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_religion_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Soothe</span>
                        <div class="row">
                            <select name="attr_soothe_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_soothe_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Stealth</span>
                        <div class="row">
                            <select name="attr_stealth_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_stealth_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Threat</span>
                        <div class="row">
                            <select name="attr_threat_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_threat_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div class="empty-row-cell">
                        <span>Hidden</span>
                        <div class="row">
                            <select>
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number"/>
                        </div>
                    </div>
                    <div>
                        <span>Wilderness</span>
                        <div class="row">
                            <select name="attr_wilderness_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_wilderness_lu"/>
                        </div>
                    </div>
                    <div class="empty-row-cell">
                        <span>Hidden</span>
                        <div class="row">
                            <select>
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number"/>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="vertical-traits hidden">
                <div class="row trait-row">
                    <div>
                        <span>Agility</span>
                        <div class="row">
                            <select name="attr_agility_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_agility_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Etiquette</span>
                        <div class="row">
                            <select name="attr_etiquette_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_etiquette_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Observation</span>
                        <div class="row">
                            <select name="attr_observation_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_observation_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Apothecary</span>
                        <div class="row">
                            <select name="attr_apothecary_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_apothecary_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Hands</span>
                        <div class="row">
                            <select name="attr_hands_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_hands_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Perseverance</span>
                        <div class="row">
                            <select name="attr_perseverance_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_perseverance_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Bargain</span>
                        <div class="row">
                            <select name="attr_bargain_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_bargain_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>History</span>
                        <div class="row">
                            <select name="attr_history_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_history_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Religion</span>
                        <div class="row">
                            <select name="attr_religion_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_religion_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Communication</span>
                        <div class="row">
                            <select name="attr_communication_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_communication_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Intuition</span>
                        <div class="row">
                            <select name="attr_intuition_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_intuition_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Soothe</span>
                        <div class="row">
                            <select name="attr_soothe_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_soothe_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Convince</span>
                        <div class="row">
                            <select name="attr_convince_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_convince_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Investigation</span>
                        <div class="row">
                            <select name="attr_investigation_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_investigation_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Stealth</span>
                        <div class="row">
                            <select name="attr_stealth_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_stealth_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Engineering</span>
                        <div class="row">
                            <select name="attr_engineering_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_engineering_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Magic</span>
                        <div class="row">
                            <select name="attr_magic_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_magic_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Threat</span>
                        <div class="row">
                            <select name="attr_threat_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_threat_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Entertainment</span>
                        <div class="row">
                            <select name="attr_entertainment_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_entertainment_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Might</span>
                        <div class="row">
                            <select name="attr_might_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_might_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Wilderness</span>
                        <div class="row">
                            <select name="attr_wilderness_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_wilderness_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div class="empty-row-cell">
                        <span>Hidden</span>
                        <div class="row">
                            <select>
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number"/>
                        </div>
                    </div>
                    <div>
                        <span>Navigation</span>
                        <div class="row">
                            <select name="attr_navigation_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_navigation"/>
                        </div>
                    </div>
                    <div class="empty-row-cell">
                        <span>Hidden</span>
                        <div class="row">
                            <select>
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number"/>
                        </div>
                    </div>
                </div>
            </div>
    
            <div class="hr"></div>
    
            <div class="centered-row">
                <span>Extra Languages: </span><input type="number" value="0" name="attr_language"/>
            </div>
            <textarea class="resize" name="attr_languages">Evritung</textarea>
        </div>



        <div class="main-width container-style bottom-padding-5px">
            <div class="row">
                <div class="hr"></div>
                <span>COMBAT</span>
                <div class="hr"></div>
            </div>

            <div class="row">
                <div class="hr"></div>
                <span class="text-color">ATTACK MODS</span>
                <div class="hr"></div>
            </div>

            <div class="row">
                <div>
                    <span>Melee</span>
                    <input type="number" value="0" name="attr_melee_lu"/>
                </div>
                <div>
                    <span>Ranged</span>
                    <input type="number" value="0" name="attr_ranged_lu"/>
                </div>
                <div>
                    <span>Spellstrike</span>
                    <input type="number" value="0" name="attr_spell_lu"/>
                </div>
            </div>

            <div class="row">
                <div>
                    <span>Effect</span>
                    <input type="number" value="0" name="attr_effect_lu"/>
                </div>
                <div>
                    <span>Ability</span>
                    <input type="number" value="0" name="attr_ability_lu"/>
                </div>
                <div>
                    <span>Environment</span>
                    <input type="number" value="0" name="attr_environment_lu"/>
                </div>
            </div>

            <div class="row">
                <div class="hr"></div>
                <span class="text-color">DEFENSE MODS</span>
                <div class="hr"></div>
            </div>

            <div class="row">
                <div>
                    <span>Melee Defense</span>
                    <input type="number" value="0" name="attr_melee_defense_lu"/>
                </div>
                <div>
                    <span>Effect Defense</span>
                    <input type="number" value="0" name="attr_effect_defense_lu"/>
                </div>
            </div>

            <div class="row">
                <div>
                    <span>Ranged Defense</span>
                    <input type="number" value="0" name="attr_ranged_defense_lu"/>
                </div>
                <div>
                    <span>Ability Defense</span>
                    <input type="number" value="0" name="attr_ability_defense_lu"/>
                </div>
            </div>

            <div class="row">
                <div>
                    <span>Spellstrike Defense</span>
                    <input type="number" value="0" name="attr_spell_defense_lu"/>
                </div>
                <div>
                    <span>Environment Defense</span>
                    <input type="number" value="0" name="attr_environment_defense_lu"/>
                </div>
            </div>

            <div class="centered-row">
                <span>Equipment Slots: </span><input type="number" value="0" name="attr_equipslots_lu"/>
            </div>

            <div class="row">
                <div>
                    <span>Acid</span>
                    <input type="number" value="0"  min="0" max="1" class="acid" name="attr_acid_lu"/>
                </div>
                <div>
                    <span>Blast</span>
                    <input type="number" value="0" min="0" max="1" class="blast" name="attr_blast_lu"/>
                </div>
                <div>
                    <span>Cold</span>
                    <input type="number" value="0" min="0" max="1" class="cold" name="attr_cold_lu"/>
                </div>
                <div>
                    <span>Death</span>
                    <input type="number" value="0" min="0" max="1" class="death" name="attr_death_lu"/>
                </div>
                <div>
                    <span>Electric</span>
                    <input type="number" value="0" min="0" max="1" class="electric" name="attr_electric_lu"/>
                </div>
            </div>
            <div class="row">
                <div>
                    <span>Fire</span>
                    <input type="number" value="0" min="0" max="1" class="fire" name="attr_fire_lu"/>
                </div>
                <div>
                    <span>Light</span>
                    <input type="number" value="0" min="0" max="1" class="light" name="attr_light_lu"/>
                </div>
                <div>
                    <span>Physical</span>
                    <input type="number" value="0" min="0" max="1" class="physical" name="attr_physical_lu"/>
                </div>
                <div>
                    <span>Poison</span>
                    <input type="number" value="0" min="0" max="1" class="poison" name="attr_poison_lu"/>
                </div>
                <div>
                    <span>Psychic</span>
                    <input type="number" value="0" min="0" max="1" class="psychic" name="attr_psychic_lu"/>
                </div>
            </div>
        </div>
    </div> <!-- end: #page-level -->
    
    
    
    
    
    <!--------------------->
    <!-- PAGE: EQUIPMENT -->
    <!--------------------->
    <div id="page_equipment" class="hidden">

        <!-- TOTAL -->
        <div class="container-style main-width">
            <div style="text-align: center;">
                <span class="header">TOTAL</span>
            </div>
            <div class="row">
                <div>
                    <span>Acid</span>
                    <input type="number" readonly="true" value="0" class="acid" name="attr_acid"/>
                </div>
                <div>
                    <span>Blast</span>
                    <input type="number" readonly="true" value="0" class="blast" name="attr_blast"/>
                </div>
                <div>
                    <span>Cold</span>
                    <input type="number" readonly="true" value="0" class="cold" name="attr_cold"/>
                </div>
                <div>
                    <span>Death</span>
                    <input type="number" readonly="true" value="0" class="death" name="attr_death"/>
                </div>
                <div>
                    <span>Electric</span>
                    <input type="number" readonly="true" value="0" class="electric" name="attr_electric"/>
                </div>
            </div>
            <div class="row">
                <div>
                    <span>Fire</span>
                    <input type="number" readonly="true" value="0" class="fire" name="attr_fire"/>
                </div>
                <div>
                    <span>Light</span>
                    <input type="number" readonly="true" value="0" class="light" name="attr_light"/>
                </div>
                <div>
                    <span>Physical</span>
                    <input type="number" readonly="true" value="0" class="physical" name="attr_physical"/>
                </div>
                <div>
                    <span>Poison</span>
                    <input type="number" readonly="true" value="0" class="poison" name="attr_poison"/>
                </div>
                <div>
                    <span>Psychic</span>
                    <input type="number" readonly="true" value="0" class="psychic" name="attr_psychic"/>
                </div>
            </div>
        </div>
        
        <!-- NATURAL ARMOR -->
        <div class="container-style main-width">
            <div style="text-align: center;">
                <span class="header">NATURAL ARMOR</span>
            </div>

            <div class="row">
                <div>
                    <span>Acid</span>
                    <input type="number" value="0" name="attr_acid_armor_nat"/>
                </div>
                <div>
                    <span>Blast</span>
                    <input type="number" value="0" name="attr_blast_armor_nat"/>
                </div>
                <div>
                    <span>Cold</span>
                    <input type="number" value="0" name="attr_cold_armor_nat"/>
                </div>
                <div>
                    <span>Death</span>
                    <input type="number" value="0" name="attr_death_armor_nat"/>
                </div>
                <div>
                    <span>Electric</span>
                    <input type="number" value="0" name="attr_electric_armor_nat"/>
                </div>
            </div>
            <div class="row">
                <div>
                    <span>Fire</span>
                    <input type="number" value="0" name="attr_fire_armor_nat"/>
                </div>
                <div>
                    <span>Light</span>
                    <input type="number" value="0" name="attr_light_armor_nat"/>
                </div>
                <div>
                    <span>Physical</span>
                    <input type="number" value="0" name="attr_physical_armor_nat"/>
                </div>
                <div>
                    <span>Poison</span>
                    <input type="number" value="0" name="attr_poison_armor_nat"/>
                </div>
                <div>
                    <span>Psychic</span>
                    <input type="number" value="0" name="attr_psychic_armor_nat"/>
                </div>
            </div>
        </div>
        
        <!-- ARMOR -->
        <div class="container-style main-width">
            <div style="text-align: center;">
                <span class="header">ARMOR</span>
            </div>
            
            <div>
                <select name="attr_armor_loadout" style="margin-left: 27%;">
                    <option value="0">None</option>
                    <option value="1">Loadout 1</option>
                    <option value="2">Loadout 2</option>
                    <option value="3">Loadout 3</option>
                </select>
            </div>

            <div class="hr"></div>
            <div style="text-align: center;">
                <span class="accent-text">ARMOR LOADOUT 1</span>
            </div>
            <div style="text-align: center; margin-bottom: 6px;">
                <input type="text" placeholder="Armor Loadout 1" title="Name" name="attr_armor_loadout_1"/>
                <input type="number" title="Weight" name="attr_armor_weight_1" class="option-equipment"/>
            </div>

            <div class="row">
                <div>
                    <span>Acid</span>
                    <input type="number" value="0" name="attr_acid_armor_1"/>
                </div>
                <div>
                    <span>Blast</span>
                    <input type="number" value="0" name="attr_blast_armor_1"/>
                </div>
                <div>
                    <span>Cold</span>
                    <input type="number" value="0" name="attr_cold_armor_1"/>
                </div>
                <div>
                    <span>Death</span>
                    <input type="number" value="0" name="attr_death_armor_1"/>
                </div>
                <div>
                    <span>Electric</span>
                    <input type="number" value="0" name="attr_electric_armor_1"/>
                </div>
            </div>
            <div class="row">
                <div>
                    <span>Fire</span>
                    <input type="number" value="0" name="attr_fire_armor_1"/>
                </div>
                <div>
                    <span>Light</span>
                    <input type="number" value="0" name="attr_light_armor_1"/>
                </div>
                <div>
                    <span>Physical</span>
                    <input type="number" value="0" name="attr_physical_armor_1"/>
                </div>
                <div>
                    <span>Poison</span>
                    <input type="number" value="0" name="attr_poison_armor_1"/>
                </div>
                <div>
                    <span>Psychic</span>
                    <input type="number" value="0" name="attr_psychic_armor_1"/>
                </div>
            </div>

            <div class="hr"></div>
            <div style="text-align: center;">
                <span class="accent-text">ARMOR LOADOUT 2</span>
            </div>
            <div style="text-align: center; margin-bottom: 6px;">
                <input type="text" placeholder="Armor Loadout 2" title="Name" name="attr_armor_loadout_2"/>
                <input type="number" title="Weight" name="attr_armor_weight_2" class="option-equipment"/>
            </div>

            <div class="row">
                <div>
                    <span>Acid</span>
                    <input type="number" value="0" name="attr_acid_armor_2"/>
                </div>
                <div>
                    <span>Blast</span>
                    <input type="number" value="0" name="attr_blast_armor_2"/>
                </div>
                <div>
                    <span>Cold</span>
                    <input type="number" value="0" name="attr_cold_armor_2"/>
                </div>
                <div>
                    <span>Death</span>
                    <input type="number" value="0" name="attr_death_armor_2"/>
                </div>
                <div>
                    <span>Electric</span>
                    <input type="number" value="0" name="attr_electric_armor_2"/>
                </div>
            </div>
            <div class="row">
                <div>
                    <span>Fire</span>
                    <input type="number" value="0" name="attr_fire_armor_2"/>
                </div>
                <div>
                    <span>Light</span>
                    <input type="number" value="0" name="attr_light_armor_2"/>
                </div>
                <div>
                    <span>Physical</span>
                    <input type="number" value="0" name="attr_physical_armor_2"/>
                </div>
                <div>
                    <span>Poison</span>
                    <input type="number" value="0" name="attr_poison_armor_2"/>
                </div>
                <div>
                    <span>Psychic</span>
                    <input type="number" value="0" name="attr_psychic_armor_2"/>
                </div>
            </div>

            <div class="hr"></div>
            <div style="text-align: center;">
                <span class="accent-text">ARMOR LOADOUT 3</span>
            </div>
            <div style="text-align: center; margin-bottom: 6px;">
                <input type="text" placeholder="Armor Loadout 3" title="Name" name="attr_armor_loadout_3"/>
                <input type="number" title="Weight" name="attr_armor_weight_3" class="option-equipment"/>
            </div>

            <div class="row">
                <div>
                    <span>Acid</span>
                    <input type="number" value="0" name="attr_acid_armor_3"/>
                </div>
                <div>
                    <span>Blast</span>
                    <input type="number" value="0" name="attr_blast_armor_3"/>
                </div>
                <div>
                    <span>Cold</span>
                    <input type="number" value="0" name="attr_cold_armor_3"/>
                </div>
                <div>
                    <span>Death</span>
                    <input type="number" value="0" name="attr_death_armor_3"/>
                </div>
                <div>
                    <span>Electric</span>
                    <input type="number" value="0" name="attr_electric_armor_3"/>
                </div>
            </div>
            <div class="row">
                <div>
                    <span>Fire</span>
                    <input type="number" value="0" name="attr_fire_armor_3"/>
                </div>
                <div>
                    <span>Light</span>
                    <input type="number" value="0" name="attr_light_armor_3"/>
                </div>
                <div>
                    <span>Physical</span>
                    <input type="number" value="0" name="attr_physical_armor_3"/>
                </div>
                <div>
                    <span>Poison</span>
                    <input type="number" value="0" name="attr_poison_armor_3"/>
                </div>
                <div>
                    <span>Psychic</span>
                    <input type="number" value="0" name="attr_psychic_armor_3"/>
                </div>
            </div>
        </div>
        
        <!-- SHIELD -->
        <div class="container-style main-width">
            <div style="text-align: center;">
                <span class="header">SHIELD</span>
            </div>

            <select name="attr_shield_loadout" style="margin-left: 27%;">
                <option value="0">None</option>
                <option value="1">Loadout 1</option>
                <option value="2">Loadout 2</option>
                <option value="3">Loadout 3</option>
            </select>
            
            <div class="hr"></div>
            <div style="text-align: center;">
                <span class="accent-text">SHIELD LOADOUT 1</span>
            </div>
            <div style="text-align: center; margin-bottom: 6px;">
                <input type="text" placeholder="Shield Loadout 1" title="Name" name="attr_shield_loadout_1"/>
                <input type="number" title="Weight" name="attr_shield_weight_1" class="option-equipment"/>
            </div>

            <div class="row">
                <div>
                    <span>Melee</span>
                    <input type="number" value="0" name="attr_melee_defense_shield_one"/>
                </div>
                <div>
                    <span>Ranged</span>
                    <input type="number" value="0" name="attr_ranged_defense_shield_one"/>
                </div>
                <div>
                    <span>Spellstrike</span>
                    <input type="number" value="0" name="attr_spell_defense_shield_one"/>
                </div>
            </div>

            <div class="row">
                <div>
                    <span>Effect</span>
                    <input type="number" value="0" name="attr_effect_defense_shield_one"/>
                </div>
                <div>
                    <span>Ability</span>
                    <input type="number" value="0" name="attr_ability_defense_shield_one"/>
                </div>
                <div>
                    <span>Environment</span>
                    <input type="number" value="0" name="attr_environment_defense_shield_one"/>
                </div>
            </div>
            
            <div class="hr"></div>
            <div style="text-align: center;">
                <span class="accent-text">SHIELD LOADOUT 2</span>
            </div>
            <div style="text-align: center; margin-bottom: 6px;">
                <input type="text" placeholder="Shield Loadout 2" title="Name" name="attr_shield_loadout_2"/>
                <input type="number" title="Weight" name="attr_shield_weight_2" class="option-equipment"/>
            </div>

            <div class="row">
                <div>
                    <span>Melee</span>
                    <input type="number" value="0" name="attr_melee_defense_shield_2"/>
                </div>
                <div>
                    <span>Ranged</span>
                    <input type="number" value="0" name="attr_ranged_defense_shield_2"/>
                </div>
                <div>
                    <span>Spellstrike</span>
                    <input type="number" value="0" name="attr_spell_defense_shield_2"/>
                </div>
            </div>

            <div class="row">
                <div>
                    <span>Effect</span>
                    <input type="number" value="0" name="attr_effect_defense_shield_2"/>
                </div>
                <div>
                    <span>Ability</span>
                    <input type="number" value="0" name="attr_ability_defense_shield_2"/>
                </div>
                <div>
                    <span>Environment</span>
                    <input type="number" value="0" name="attr_environment_defense_shield_2"/>
                </div>
            </div>
            
            <div class="hr"></div>
            <div style="text-align: center;">
                <span class="accent-text">SHIELD LOADOUT 3</span>
            </div>
            <div style="text-align: center; margin-bottom: 6px;">
                <input type="text" placeholder="Shield Loadout 3" title="Name" name="attr_shield_loadout_3"/>
                <input type="number" title="Weight" name="attr_shield_weight_3" class="option-equipment"/>
            </div>

            <div class="row">
                <div>
                    <span>Melee</span>
                    <input type="number" value="0" name="attr_melee_defense_shield_3"/>
                </div>
                <div>
                    <span>Ranged</span>
                    <input type="number" value="0" name="attr_ranged_defense_shield_3"/>
                </div>
                <div>
                    <span>Spellstrike</span>
                    <input type="number" value="0" name="attr_spell_defense_shield_3"/>
                </div>
            </div>

            <div class="row">
                <div>
                    <span>Effect</span>
                    <input type="number" value="0" name="attr_effect_defense_shield_3"/>
                </div>
                <div>
                    <span>Ability</span>
                    <input type="number" value="0" name="attr_ability_defense_shield_3"/>
                </div>
                <div>
                    <span>Environment</span>
                    <input type="number" value="0" name="attr_environment_defense_shield_3"/>
                </div>
            </div>
        </div>

    </div> <!-- end: #page-equipment -->
    
    
    
    
    
    <!---------------------->
    <!-- PAGE: CHEATSHEET -->
    <!---------------------->
    <div id="page_cheatsheet" class="hidden">
        <h1 style="color: inherit">DEFENSE</h1> <!--TPTODO-->
    
        <div class="cheatsheet-header">
            <div class="container-style" style="padding: 5px; margin-bottom:6px;">
                <p>Defense actions are actions that every creature can take when they succeed a defense roll vs an attack. When a creature succeeds on their defense roll they can immediately choose to either parry or use a technique</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Parry</h3>
                <p>When you succeed on a defense roll against an attack, you can choose to parry and then attempt to make a counterattack. Parrying costs 2 tactical actions normally, and 1 tactical action if you’re dual-wielding; additionally, brutal defenses will decrease this action cost by 1 tactical action each, potentially making the parry into a free action. Alternatively, you can choose to parry as a main action; this cannot benefit from brutal defenses.</p>
            </div>
        </div>
        
        <h1 style="color: inherit">TECHNIQUES</h1> <!--TPTODO-->
    
        <div class="cheatsheet-header">
            <div class="container-style" style="padding: 5px; margin-bottom:6px;">
                <p>Simple techniques cost a tactical action. Advanced techniques cost a tactical action and 5 MP.</p>
            </div>
            
            <div class="container-style" style="margin: 0px auto; margin-top: 6px;  margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">SIMPLE:</h3>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Disengage</h3>
                <p>Until your action rest, other creatures cannot take opportunity actions against you as a result of you moving out of adjacency with them.</p>
            </div>

            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Hide</h3>
                <p>While inside combat, the hide technique will allow you to prevent creatures from noticing you (Note that when outside of combat, attempting to hide from a creature will provoke a stealth trait roll vs their stealth TC as per normal trait rules). Make an offense environment roll vs the defense environment rolls of all creatures who can see or hear you and wish to stop you from hiding; if you fail any of these rolls, then you fail to hide. Hiding will allow you to not be targeted directly by attacks or abilities; furthermore while hidden, you do not remake the initial roll when entering new creatures’ line of sight. However, other creatures still have a general idea of where you are, and can use AoE abilities centered on your location. You will stop hiding if you take any action (including dashing and defense actions, but not defense rolls themselves) or if a creature uses the search technique on you</p>
            </div>

            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Maneuver</h3>
                <p>You can lunge, roll, or tumble up to 2 tiles in a direction of your choice; this does not affect your base movement speed. You can still be affected by opportunity actions.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Object</h3>
                <p>You can interact with one object or equipment in the following ways: swapping something on your person, storing, drawing, donning, removing, dropping, reloading, throwing it non-harmfully up to 5 tiles away, catching, passing it to another creature, ingest one thing, using it, or adjusting which hand or the number of hands a weapon is in. </p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Plummet</h3>
                <p> Select one target you can see or can hear you and choose an effect such as screaming at them, a commanding stare, magical vines, next attack, etc. to attempt to knock a creature out of the air as part of this tactical action. The target makes a defense effect roll vs your offensive effect roll. The larger creature gains +1 ADV for each size advantage. On a fail, the target immediately stops flying/ hovering and falls to the ground (taking any fall damage).</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Purify</h3>
                <p>Make an offensive effect roll vs the defense effect roll of the target that applied or is applying the status effect. On a success, you remove the status effect.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Search</h3>
                <p>Choose a hidden target that is within your line of sight and make an offense environment roll vs their defense environment roll in order to locate them. If you succeed, they are no longer hidden.</p>
            </div>

            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Shove</h3>
                <p>One target within your reach must make a defense effect roll vs your offensive effect roll. The larger creature has +1 ADV to this roll for each size advantage. On a fail, the target is pushed horizontally in a direction of your choice up to 2 tiles + 1 tile per your size advantage. If you are wielding a shield you can attempt to push all targets of your choice adjacent to the original target.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Target</h3>
                <p>Select a specific place, object, equipment, etc. to affect or disarm. Any rolls of your choice that you make until your actions reset to target the selected thing has +1 DisADV to do so. A creature has +1 ADV to this roll if you attempt to disarm them and they are holding the object in two hands or more. On a success, you are able to target what you intended to and the FD may apply additional fair effects for what was targeted. For example you can disarm a target's weapon, dropping it on any tile of your choice occupied by the disarmed creature, or shoot an arrow into a target's eye, potentially giving them the blinded status effect, etc.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Trip</h3>
                <p>Select one target within your reach. That target must make a defense effect roll vs your offense effect roll, and the larger creature gains +1 ADV for each size advantage. On a failure, the target is forced prone.</p>
            </div>
            
            <div class="container-style" style="margin-top: 6px; margin-bottom:6px;">
                <h3 style="color: inherit">ADVANCED:</h3>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Aggro</h3>
                <p>One target of your choice that can see or hear you must make a defense effect roll vs your offensive effect roll. A creature gains +1 ADV based on their size ADV. On a failure, they gain the aggroed status effect.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Block</h3>
                <p>The next defense roll of your choice that you make in the next minute gains +1 ADV.</p>
            </div>

            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Charge</h3>
                <p>You can move through enemy spaces without it being difficult terrain. You still are affected by opportunity actions from this movement. Additionally, once per creature you move through can make a defense effect roll vs your offense effect roll. A creature gets +1 ADV to this roll based on their size ADV. On a fail the target takes true damage equal to ½ your total level.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Help</h3>
                <p>When a target within your reach makes a 2d10 roll, before the roll is made you can give them +1 ADV on that roll. Creatures cannot benefit from more than one help technique on a single roll.</p>
            </div>

            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Intimidate</h3>
                <p>One target of your choice that can see or hear you must make a defense effect roll vs your offensive effect roll. The larger creature gains +1 ADV for each size advantage. On a fail, they gain the frightened status effect</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px; width: 832px;">
                <h3 style="color: inherit">Launch</h3>
                <p>Select one willing creature within your reach to throw up to 5 tiles in the direction of your choice. The distance you can throw them is increased by +2 tiles for every size advantage above the thrown creature. The throw itself does no damage and the target is assumed to successfully land on their feet, unless they were already prone in which case they will remain prone after landing. (Note that the thrown target is susceptible to fall damage.)</p>
            </div>
        </div>
        
        <div style="height: 30px"></div> <!--TPTODO-->
        <h1 style="color: inherit">GRAPPLING</h1>

        <div class="container-style" style="padding: 5px; margin-bottom:6px;">
            <p>Grappling is a combat technique that involves grabbing, holding, or restraining an opponent in close-quarters physical engagement. It is used to control an enemy's movement, limit their actions, or set up for subsequent attacks or maneuvers. Grappling can involve various techniques such as slamming, throws, pins, etc. It requires strategic positioning to gain an advantage over the opponent. Successful grappling can provide opportunities for controlling the battlefield and neutralizing threats.</p>
        </div>
    
        <div class="cheatsheet-header">
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Grapple Check</h3>
                <p>As a main action, you can attempt to grapple a target with a free hand within your reach. You must make an offense effect roll vs the target's defense effect roll, a creature gains +1 ADV based on their size ADV. If you win you successfully grapple them. The creature doing the grappling is known as the grappler, and the target being grappled is known as the grappled target. Any forced movement will cause any creature that wants to hold on to make a defense roll of the same type as the offense roll that forced the movement, and if they succeed this roll, they can choose to either move with the target or stop the forced movement entirely.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Moving While Grappling</h3>
                <p>Unless otherwise stated, both creatures can still move each other whenever they would move. However, the grappler and grappled target have all movement speeds halved. When either target attempts to move or dash they both must remake the grapple check and if the target initiating the move wins, they can successfully move with the other target.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Escaping A Grapple</h3>
                <p>While grappled the grappled target can spend a tactical action to attempt to escape the grapple by remaking the grapple check vs the grappler. On a success the grappled target breaks free of the grapple. The grappler can willingly let go or stop grappling as a free action.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Grappling Techniques</h3>
                <p>Grappling techniques are different maneuvers used while grappling to try and gain an advantage in combat; these replace your normal techniques while grappling, except for the Purify technique which is still usable. Whenever you use a grappling technique you must remake the contested grapple check to determine whether or not the grappling technique works. If you succeed the grappling technique takes effect. If they succeed the grappling technique does not occur but they remain grappled.</p>
                <ul>
                    <li><b>Body Block:</b> When you are targeted by an attack or effect that deals damage you can spend a main action to attempt to reposition the grappled target between you and the damage source. If successful, the grappled target takes half of the damage and you take the remainder.</li>
                    <li><b>Pin:</b> As a main action you can attempt to pin a grappled target into the ground (if they are prone) or solid object such as a wall. If you succeed, the grappled target's speed is reduced to 0, all attacks against the grappled target have +1 ADV. The grappled target can spend 1 main action to automatically escape the pin. If you pin the grappled target against the ground, the grappled target cannot stand up until it escapes the pin.</li>
                    <li><b>Slam:</b>  As a main action you can attempt to slam a grappled target into something. If you succeed the grappled target takes true damage equal to your 2 + total level. If the grappled target is slammed into another creature the grappled target takes half the damage, and the other creature takes the remaining damage (minimum of 1).</li>
                    <li><b>Takedown:</b> As a main action you can attempt to take down or sweep a grappled target. If you succeed, the grappled target falls prone.</li>
                    <li><b>Throw:</b> As a main action you can attempt to throw a grappled target up to 5 tiles away +1 tile for each size advantage you are above the grappled target. If you succeed the target takes collision or fall damage as normal.</li>
                </ul>
            </div>
        </div>
    </div> <!-- end: #page-cheatsheet -->
    


    <!-- Only one fieldset is allowed, so we must reuse it across pages -->
    <div id="arsenal_container" class="container-style main-width">
        <div class="header-row">
            <button type="action" class="empty-row-cell"></button>
            <span>Arsenal</span>
        </div>
        
        <div class="header-hr"></div>

        <div class="combat-mods hidden">
            <div class="row top-padding-6px">
                <div class="hr"></div>
                <span class="text-color">CUSTOM MODS</span>
                <div class="hr"></div>
            </div>
            <div class="row">
                <div>
                    <span>ADVANTAGE</span>
                    <input type="number" name="attr_ability_advantage" value="0" />
                </div>
                <div>
                    <span>MODIFIER</span>
                    <input type="number" name="attr_ability_accuracy" value="0" />
                </div>
                <div>
                    <span>DAMAGE</span>
                    <input type="number" name="attr_ability_global_damage" value="0" />
                </div>
                <div>
                    <span>CRIT. RANGE</span>
                    <input type="number" name="attr_ability_global_critmin" value="20" />
                </div>
            </div>
            
            <div class="row">
                <div class="hr"></div>
                <span class="text-color">ATTACK MODS</span>
                <div class="hr"></div>
            </div>
    
            <div class="row">
                <button type="action" name="act_melee"><input style="width: 25px !important;" type="number" value="0" name="attr_melee" readonly="true"/><span>Melee</span></button>
                <button type="action" name="act_ranged"><input style="width: 25px !important;" type="number" value="0" name="attr_ranged" readonly="true"/><span>Ranged</span></button>
                <button type="action" name="act_spell" style="width:112px; text-align:center;"><input style="width: 25px !important;" type="number" value="0" name="attr_spell" readonly="true"/><span>Spellstrike</span></button>
            </div>
            <div class="row">
                <button type="action" name="act_effect"><input style="width: 25px !important;" type="number" value="0" name="attr_effect" readonly="true"/><span>Effect</span></button>
                <button type="action" name="act_ability"><input style="width: 25px !important;" type="number" value="0" name="attr_ability" readonly="true"/><span>Ability</span></button>
                <button type="action" name="act_environment" style="width:112px; text-align:center;"><input style="width: 25px !important;" type="number" value="0" name="attr_environment" readonly="true"/><span>Environment</span></button>
            </div>
            
            <div class="hr"></div>
        </div>

        <div class="ability-category">
            <div class="row">
                <button type="action" class="allCategory selected" name="act_allCategory"><span>All</span></button>
                <button type="action" class="weaponCategory" name="act_weaponCategory"><span>Weapon</span></button>
                <button type="action" class="spellCategory" name="act_spellCategory"><span>Spell</span></button>
                <button type="action" class="classAbilityCategory" name="act_classAbilityCategory"><span>Class Ability</span></button>
            </div>
            <div class="row">
                <button type="action" class="speciesAbilityCategory" name="act_speciesAbilityCategory"><span>Species Ability</span></button>
                <button type="action" class="loreAbilityCategory" name="act_loreAbilityCategory"><span>Lore Ability</span></button>
                <button type="action" class="equipmentCategory" name="act_equipmentCategory"><span>Equipment</span></button>
                <button type="action" class="inventoryCategory" name="act_inventoryCategory"><span>Inventory</span></button>
            </div>
        </div>
        
        <div class="hr hidden"></div>
        
        <fieldset class="repeating_abilities">
            <input class="ability-category" type="hidden" name="attr_ability_category" value="1" />
            <div class="ability-full">

                <div class="hr"></div>
                <input class="ability-layout" type="hidden" name="attr_ability_layout" value="1" />
                <div class="ability main-width">

                    <div class="ability-header">
                        <button type="action" name="act_collapse" title="Show/Hide Details"></button>

                        <input type="text" class="ability-color" name="attr_ability_name" title="Name" />
        
                        <div class="ability-uses hidden">
                            <input type="number" name="attr_ability_uses" title="Remaining Uses" style="width: 50px !important"/>
                            <span>/</span>
                            <input type="number" name="attr_ability_uses_max" title="Max Uses" style="width: 50px !important" />
                        </div>

                        <input type="number" name="attr_ability_weight" title="Weight" style="width: 50px !important" class="option-equipment ability-weight hidden" />
        
                        <button type="action" name="act_layout" title="Change Layout"></button>
                    </div>
            
                    <input class="ability-collapse" type="hidden" name="attr_ability_collapse" value="1" />
                    <div class="content">
                        <div class="ability-attack hidden">
                            <div class="ability-attack-header">
                                <input type="number" class="ability-base-damage" name="attr_ability_damage" placeholder="Base Dmg." title="Damage" />
                                <input type="text" name="attr_ability_damage_type" placeholder="Damage Type" title="Damage Type"/> <!--TPTODO fix styling -->
                                <span>+</span>
                                <input type="number" class="ability-brutal-damage" name="attr_ability_brutal" placeholder="Brutal Dmg." title="Brutal Damage"/>
                                
                                <input class="ability-load" type="hidden" name="attr_ability_load" />
                                <button type="action" class="load-button hidden" name="act_load" title="Is your weapon loaded?" >
                                    <span class="loaded">Loaded</span>
                                    <span class="unloaded">Unloaded</span>
                                </button>
                            </div>
            
                            <div class="row ability-attack-content">
                                <div class="melee hidden">
                                    <button type="action" name="act_melee" title="Make a melee attack!"><span>Melee</span></button>
                                    <input type="number" name="attr_ability_melee_range" placeholder="Range (Tiles)" title="Melee Range" style="width: 102px !important; max-width: 102px !important;"/>
                                </div>
                                <div class="ranged hidden">
                                    <button type="action" name="act_ranged" title="Make a ranged attack!"><span>Ranged</span></button>
                                    <input type="number" name="attr_ability_ranged_range" placeholder="Range (Tiles)" title="Ranged Range" style="width: 102px !important; max-width: 102px !important;"/>
                                </div>
                                <div class="spell hidden">
                                    <button type="action" name="act_spell" title="Make a spell attack!"><span>Spellstrike</span></button>
                                    <input type="number" name="attr_ability_spell_range" placeholder="Range (Tiles)" title="Spellstrike Range" style="width: 102px !important; max-width: 102px !important;"/>
                                </div>
                                <div class="effect hidden">
                                    <button type="action" name="act_effect" title="Make an effect attack!"><span>Effect</span></button>
                                    <input type="number" name="attr_ability_effect_range" placeholder="Range (Tiles)" title="Effect Range" style="width: 102px !important; max-width: 102px !important;"/>
                                </div>
                                <div class="ability hidden">
                                    <button type="action" name="act_ability" title="Make an ability attack!"><span>Ability</span></button>
                                    <input type="number" name="attr_ability_ability_range" placeholder="Range (Tiles)" title="Ability Range" style="width: 102px !important; max-width: 102px !important;"/>
                                </div>
                                <div class="environment hidden">
                                    <button type="action" name="act_environment" title="Make an environment attack!"><span>Environment</span></button>
                                    <input type="number" name="attr_ability_environment_range" placeholder="Range (Tiles)" title="Environment Range" style="width: 102px !important; max-width: 102px !important;"/>
                                </div>
                            </div>
                        </div>
                
                        <div class="ability-description hidden">
                            <textarea name="attr_ability_text" title="Ability Description"></textarea>
                        </div>
                    </div>
                    <div class="settings">
                        <div class="row">
                            <div></div>
                            <div>
                                <span>CATEGORY</span>
                                <select class="category ability-color" name="attr_category">
                                    <option class="option-none">None</option>
                                    <option class="option-weapon">Weapon</option>
                                    <option class="option-spell">Spell</option>
                                    <option class="option-class-ability">Class Ability</option>
                                    <option class="option-species-ability">Species Ability</option>
                                    <option class="option-lore-ability">Lore Ability</option>
                                    <option class="option-equipment">Equipment</option>
                                    <option class="option-inventory">Inventory</option>
                                </select>
                            </div>
                            <div></div>
                        </div>
                        <div class="row">
                            <div>
                                <span>Has Description?</span><input type="checkbox" class="hasdescription" name="attr_ability_hasdescription" checked="true"/>
                            </div>
                            <div>
                                <span>Has Uses?</span><input type="checkbox" class="hasuses" name="attr_ability_hasuses"/>
                            </div>
                            <div>
                                <span>Has Weight?</span><input type="checkbox" class="hasweight" name="attr_ability_hasweight"/>
                            </div>
                            <div>
                                <span>Reloading</span><input type="checkbox" class="hasammo" name="attr_ability_hasammo"/>
                            </div>
                        </div>
                        <div class="row">
                            <div>
                                <span>Melee</span><input type="checkbox" class="hasmelee" name="attr_ability_hasmelee"/>
                            </div>
                            <div>
                                <span>Ranged</span><input type="checkbox" class="hasranged" name="attr_ability_hasranged"/>
                            </div>
                            <div>
                                <span>Spellstrike</span><input type="checkbox" class="hasspell" name="attr_ability_hasspell"/>
                            </div>
                        </div>
                        <div class="row">
                            <div>
                                <span>Effect</span><input type="checkbox" class="haseffect" name="attr_ability_haseffect"/>
                            </div>
                            <div>
                                <span>Ability</span><input type="checkbox" class="hasability" name="attr_ability_hasability"/>
                            </div>
                            <div>
                                <span>Environment</span><input type="checkbox" class="hasenvironment" name="attr_ability_hasenvironment"/>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </fieldset>
    </div>
    
    
    
    </div>
    
    
    
    
    
    <!-- Displays roll results in Roll20's chat, ID is "r_template" -->
    <!-- This is hidden on the character sheet inside Roll20, but it displays incorrectly if this file is loaded as pure .html -->
    <rolltemplate class="sheet-rolltemplate-r_template">
        <!-- At the time of this writing, Roll20's StartRoll() function is incapable of
        creating GM-only rolls (i.e. rolls that only the GM can see).
        
        The following is a nasty workaround to hide rolls from clients. In essence, if the "hide-rolls"
        button is checked, the roll template will output a roll with its important info set to 'display:none;'. 
        In order for the GM to see the roll, they need to set up a third-party browser extension
        (such as Stylus) with the following snippet of CSS:
        .sheet-template-container { display:block !important; }
    
        These rolls are therefore entirely secured through obscurity, much to my displeasure. -->
        
        {{#rollTotal() hidden_roll 0}}
        <div class="sheet-template-container" style="border-style:groove; padding:5px;">
            {{#rollTotal() global_mods_applied 1}}
            <span style="font-size: 12px; opacity: 50%; position: relative; bottom: 6px; left: 10px;">GLOBAL MODIFIERS HAVE BEEN APPLIED</span>
            {{/rollTotal() global_mods_applied 1}}
            {{#rollTotal() local_mods_applied 1}}
            <span style="font-size: 12px; opacity: 50%; position: relative; bottom: 6px; left: 10px;">LOCAL MODIFIERS HAVE BEEN APPLIED</span>
            {{/rollTotal() local_mods_applied 1}}
            <div>
                <!-- If crit success, show crit roll value in green -->
                {{#rollGreater() computed::roll roll}}
                <span style="font-size: 14px; color: #00D300;">{{computed::roll}}</span>
                {{/rollGreater() computed::roll roll}}
    
                <!-- If fumble, show fumble roll value in red -->
                {{#rollLess() computed::roll roll}}
                <span style="font-size: 14px; color: red;">{{computed::roll}}</span>
                {{/rollLess() computed::roll roll}}
    
                <!-- Otherwise, show default roll value -->
                {{#rollTotal() computed::roll roll}}
                <span style="font-size: 14px;">{{computed::roll}}</span>
                {{/rollTotal() computed::roll roll}}
                <span style="display: inline; overflow: hidden; text-overflow: ellipsis; margin-left: 2px; font-size: 16px; font-weight: bold;">{{roll_name}}{{#rollTotal() is_attack 1}} [{{damage_type}}]{{/rollTotal() is_attack 1}}</span>
            </div>
            {{#rollTotal() is_attack 1}}
            <div style="width: 75%; margin-top: 6px;">
                <span style="font-size: 16px; display: block; margin-bottom: 3px;"><b>{{damage}}</b> damage</span>
                <span style="font-size: 15px; display: block; margin-bottom: 3px;"><b>{{brutal_damage}}</b> brutal damage</span>
                <span style="font-size: 15px; display: block; margin-bottom: 3px;"><b>{{attack_type}}</b> attack</span>
                <span style="font-size: 15px; display: block; margin-bottom: 3px;"><b>{{TC}}</b> TC</span>
            </div>
            {{/rollTotal() is_attack 1}}
            {{#rollTotal() is_attack 2}}
            <div style="width: 75%; margin-top: 6px;">
                <span style="font-size: 15px; display: block; margin-bottom: 3px;"><b>{{TC}}</b> TC</span>
            </div>
            {{/rollTotal() is_attack 2}}
            <div style="text-align: right;">
                <span style="width: 40%; margin-top: 6px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 13px;">{{character_name}}</span>
            </div>
        </div>
        {{/rollTotal() hidden_roll 0}}
    <!------------------------------------->
        {{#rollTotal() hidden_roll 1}}
        <div style="border-style:groove; padding:5px;">
            <span style="font-size: 12px; opacity: 50%; left: 10px;">FD-ONLY ROLL</span>
            <div class="sheet-template-container" style="display: none; position: relative; top: 6px; padding-bottom: 6px;">
                {{#rollTotal() global_mods_applied 1}}
                <span style="font-size: 12px; opacity: 50%; position: relative; bottom: 6px; left: 10px;">GLOBAL MODIFIERS HAVE BEEN APPLIED</span>
                {{/rollTotal() global_mods_applied 1}}
                {{#rollTotal() local_mods_applied 1}}
                <span style="font-size: 12px; opacity: 50%; position: relative; bottom: 6px; left: 10px;">LOCAL MODIFIERS HAVE BEEN APPLIED</span>
                {{/rollTotal() local_mods_applied 1}}
        
                <div>
                    <!-- If crit success, show crit roll value in green -->
                    {{#rollGreater() computed::roll roll}}
                    <span style="font-size: 14px; color: #00D300;">{{computed::roll}}</span>
                    {{/rollGreater() computed::roll roll}}
        
                    <!-- If fumble, show fumble roll value in red -->
                    {{#rollLess() computed::roll roll}}
                    <span style="font-size: 14px; color: red;">{{computed::roll}}</span>
                    {{/rollLess() computed::roll roll}}
        
                    <!-- Otherwise, show default roll value -->
                    {{#rollTotal() computed::roll roll}}
                    <span style="font-size: 14px;">{{computed::roll}}</span>
                    {{/rollTotal() computed::roll roll}}
                    <span style="display: inline; overflow: hidden; text-overflow: ellipsis; margin-left: 2px; font-size: 16px; font-weight: bold;">{{roll_name}}{{#rollTotal() is_attack 1}} [{{damage_type}}]{{/rollTotal() is_attack 1}}</span>
                </div>
                {{#rollTotal() is_attack 1}}
                <div style="width: 75%; margin-top: 6px;">
                    <span style="font-size: 16px; display: block; margin-bottom: 3px;"><b>{{damage}}</b> damage</span>
                    <span style="font-size: 15px; display: block; margin-bottom: 3px;"><b>{{brutal_damage}}</b> brutal damage</span>
                    <span style="font-size: 15px; display: block; margin-bottom: 3px;"><b>{{attack_type}}</b> attack</span>
                    <span style="font-size: 15px; display: block; margin-bottom: 3px;"><b>{{TC}}</b> TC</span>
                </div>
                {{/rollTotal() is_attack 1}}
                {{#rollTotal() is_attack 2}}
                <div style="width: 75%; margin-top: 6px;">
                    <span style="font-size: 15px; display: block; margin-bottom: 3px;"><b>{{TC}}</b> TC</span>
                </div>
                {{/rollTotal() is_attack 2}}
                <div style="text-align: right;">
                    <span style="width: 40%; margin-top: 6px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 13px;">{{character_name}}</span>
                </div>
            </div>
        </div>
        {{/rollTotal() hidden_roll 1}}
    </rolltemplate>
    
    
    
    
    
    <!------------>
    <!-- SCRIPT -->
    <!------------>
    <script type="text/worker">
const attacklist = ["melee", "ranged", "spell", "effect", "ability", "environment"];
const defenselist = ["melee_defense", "ranged_defense", "spell_defense", "effect_defense", "ability_defense", "environment_defense"];
const tolerancelist = ["acid", "blast", "cold", "death", "electric", "fire", "light", "physical", "poison", "psychic"];



/********************/
/* HELPER FUNCTIONS */
/********************/

const capitalizeFirstLetter = function (input) {
    if(input.length <= 1){
        return input.toUpperCase();
    } else { // Replace '_' with white space
        const inputWords = input.split('_');
        let result = '';
        inputWords.forEach(word => { result += ' ' + word.charAt(0).toUpperCase() + word.slice(1)});
        return result.slice(1); // Remove opening space
    }
}

const LEcalc = function (level, LE) {
    if(LE == 0){
        return 0;
    } else {
        return LE - 1 + Math.ceil(parseInt(level || 1)/2);
    }
}

// Tolerances and weaknesses
const updateTolerance = (tolerance) => {
    getAttrs(["character_level", `${tolerance}_lu`, "armor_loadout", `${tolerance}_armor_1`, `${tolerance}_armor_2`, `${tolerance}_armor_3`, `${tolerance}_armor_nat`], function(data) {
        let val = LEcalc(data.character_level, parseInt(data[`${tolerance}_lu`] || 0)) + (data.armor_loadout == "1") * parseInt(data[`${tolerance}_armor_1`] || 0) + (data.armor_loadout == "2") * parseInt(data[`${tolerance}_armor_2`] || 0) + (data.armor_loadout == "3") * parseInt(data[`${tolerance}_armor_3`]) + parseInt(data[`${tolerance}_armor_nat`] || 0);
        setAttrs({
            [`${tolerance}`]: val
        });
    });
};
tolerancelist.forEach(tolerance => {
    on(`change:${tolerance}_lu change:armor_loadout change:${tolerance}_armor_1 change:${tolerance}_armor_2 change:${tolerance}_armor_3 change:${tolerance}_armor_nat change:character_level sheet:opened`, function() {
        updateTolerance(tolerance);
    });
});



/******************/
/* ROLL FUNCTIONS */
/******************/

// Function to make a dice roll
const _makeRoll = (data) => {
    let rollText;
    if(data.advantage >= 0){
        // If player has advantage, take highest
        rollText = `[[2 + ${data.advantage}]]d10kh2cs>21cf<0 + ${data.bonus}`;
    } else {
        // If player has disadvantage, take lowest
        rollText = `[[2 + ${data.advantage} * -1]]d10kl2cs>21cf<0 + ${data.bonus}`;
    }

    let isAttack = (data.is_attack ? 1 : 0);
    if (isAttack === 0 && attacklist.includes(data.roll_name.toLowerCase())) {
        isAttack = 2;
    }
    const critMin = (data.crit_min ? data.crit_min : 20);
    const hiddenRoll = (data.hidden_roll == "on" ? 1 : 0);

    let startRollInput = `&{template:r_template}`
    startRollInput += `{{roll=[[${rollText}]]}}`
    startRollInput += `{{hidden_roll=[[${hiddenRoll}d1]]}}`
    
    startRollInput += `{{global_mods_applied=[[${(data.global_mods_applied ? 1 : 0)}d1]]}}`
    startRollInput += `{{local_mods_applied=[[${(data.local_mods_applied ? 1 : 0)}d1]]}}`
    
    startRollInput += `{{roll_name=${data.roll_name}}}`
    startRollInput += `{{character_name=${data.character_name}}}`

    startRollInput += `{{is_attack=[[${isAttack}d1]]}}`
    startRollInput += `{{damage_type=${data.damage_type}}}`
    startRollInput += `{{damage=${data.damage}}}`
    startRollInput += `{{brutal_damage=${data.brutal_damage}}}`
    startRollInput += `{{attack_type=${data.attack_type}}}`
    
    startRollInput += `{{TC=${11 + data.bonus}}}`

    startRoll(startRollInput, (results) => {
        let original = results.results.roll.result;
        let computed = original - data.bonus;
        
        // Determines if the number is a crit
        // "computed" cannot be directly compared to an integer using "==", so comparisons are instead made using ">"
        if(computed > critMin - 1){ //This is a crit
            computed  = original + 10;
        } else if(computed < 3) { //This is a critfail
            computed = 0;
        } else {
            computed = original;
        }

        finishRoll(
            results.rollId,
            {
                roll: computed
            }
        );
    });
}
// Creates the rolls for traits and defenses
const simpleRollBuilder = function (clicked_type, clicked_name) {
    getAttrs(["hidden_roll", "character_name", `${clicked_name}`, `${clicked_name}_advantage`, "advantage", "modifier", `${clicked_type}_advantage`, `${clicked_type}_modifier`, `${clicked_type}_minimum`], function(data) {
        let rollData = {
            "bonus": parseInt(data[`${clicked_name}`]) + parseInt(data.modifier) + parseInt(data[`${clicked_type}_modifier`]),
            "advantage": parseInt(data.advantage) + parseInt(data[`${clicked_type}_advantage`]) + (clicked_type == "trait" ? parseInt(data[`${clicked_name}_advantage`]) : 0),
            "crit_min": parseInt(data[`${clicked_type}_minimum`]),
            "character_name": data.character_name,
            "roll_name": capitalizeFirstLetter(clicked_name),
            "global_mods_applied": (data.advantage != 0 || data.modifier != 0),
            "local_mods_applied": (data[`${clicked_type}_advantage`] != 0 || data[`${clicked_type}_modifier`] != 0 || data[`${clicked_type}_minimum`] != 20),
            "hidden_roll": data.hidden_roll,
        }
        _makeRoll(rollData);
    })
}

// Handles trait button presses
const traitlist = ["agility", "apothecary", "bargain", "communication", "convince", "engineering", "entertainment", "etiquette", "hands", "history", "intuition", "investigation", "magic", "might", "navigation", "observation", "perseverance", "religion", "soothe", "stealth", "threat", "wilderness"];
traitlist.forEach(trait => {
    on(`clicked:${trait}`, function() {
        simpleRollBuilder("trait", trait);
    });
    on(`change:${trait}_lu change:character_level sheet:open`, function() {
        getAttrs([`${trait}_lu`, "character_level"], function(data) {
            setAttrs({
                [`${trait}`]: LEcalc(data.character_level, parseInt(data[`${trait}_lu`]))
            });
        });
    });
});
//Handles defense button presses
defenselist.forEach(defense => {
    on(`clicked:${defense}`, function() {
        simpleRollBuilder("defense", defense);
    });
    on(`change:${defense}_lu change:${defense}_shield_one change:${defense}_shield_2 change:${defense}_shield_3 change:character_level change:shield_loadout sheet:open`, function() {
        getAttrs([`${defense}_lu`, `${defense}_shield_one`, `${defense}_shield_2`, `${defense}_shield_3`, "character_level", "shield_loadout"], function(data) {
            setAttrs({
                [`${defense}`]: (data.shield_loadout == "1") * parseInt(data[`${defense}_shield_one`]) + (data.shield_loadout == "1") * parseInt(data[`${defense}_shield_2`]) + (data.shield_loadout == "1") * parseInt(data[`${defense}_shield_3`]) + LEcalc(data.character_level, parseInt(data[`${defense}_lu`]))
            });
        });
    });
});

// Handles outside-ability offense button presses
attacklist.forEach(attack => {
    on(`clicked:${attack}`, function() {
        getAttrs(["hidden_roll", "character_name", `${attack}`, "advantage", "modifier", "ability_advantage", "ability_accuracy", "ability_global_critmin"], function(data) {
            let rollData = {
                "bonus": parseInt(data[`${attack}`]) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
                "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
                "crit_min": parseInt(data.ability_global_critmin),
                "character_name": data.character_name,
                "roll_name": capitalizeFirstLetter(attack),
                "mods_applied": (data.advantage != 0 || data.modifier != 0 || data.ability_global_critmin != 0),
                "hidden_roll": data.hidden_roll,
            }
            _makeRoll(rollData);
        })
    });
    on(`change:${attack}_lu change:character_level sheet:opened`, function() {
        getAttrs(["character_level", `${attack}_lu`], function(data) {
            setAttrs({
                [`${attack}`]: LEcalc(data.character_level, parseInt(data[`${attack}_lu`])) + 3
            });
        });
    });
});



/******************/
/* HTML FUNCTIONS */
/******************/

// Switches pages
const pagelist = ["combat","roleplay","equipment","level","cheatsheet"];
pagelist.forEach(pagebutton => {
    on(`clicked:${pagebutton}`, function() {
        pagelist.forEach(page => $20(`#page_${page}`).addClass("hidden"));
        $20("#page_" + pagebutton).removeClass("hidden");
        if(pagebutton == "combat" || pagebutton == "roleplay"){
            $20("#arsenal_container").removeClass("hidden");
            if(pagebutton == "combat"){
                $20(".combat-mods").removeClass("hidden");
            } else {
                $20(".combat-mods").addClass("hidden");
            }
        } else {
            $20("#arsenal_container").addClass("hidden");
        }
    });
});
// Handles sheet color
on("change:settings_color sheet:opened", function(eventInfo) {
    getAttrs(["settings_color"], function(data) {
        if(eventInfo.previousValue){
            $20("#full_sheet").removeClass(eventInfo.previousValue.toLowerCase());
        }
        $20("#full_sheet").addClass(data.settings_color.toLowerCase());
    });
});
// Handles ability to switch action tracker type
on("change:action_tracker_select sheet:opened", function(eventInfo) {
    getAttrs(["action_tracker_select"], function(data) {
        let classToHide;
        if(eventInfo.previousValue){
            classToHide = eventInfo.previousValue.toLowerCase();
        } else {
            classToHide = "legend";
        }
        $20(".actions." + classToHide).addClass("hidden");
        $20(".actions." + data.action_tracker_select.toLowerCase()).removeClass("hidden");
    });
});
// Handles trait direction
on("change:settings_traitdirection sheet:opened", function() {
    getAttrs(["settings_traitdirection"], function(data) {
        if(data.settings_traitdirection === "Horizontal"){
            $20(".horizontal-traits").removeClass("hidden");
            $20(".vertical-traits").addClass("hidden");
        } else {
            $20(".horizontal-traits").addClass("hidden");
            $20(".vertical-traits").removeClass("hidden");
        }
    });
});
// Handles sheet collapses
const collapselist = ["character","traits","stats","dcdefense","flawedlegend"];
collapselist.forEach(collapse => {
    on(`clicked:${collapse}_collapse sheet:opened`, function(e) {
        getAttrs([`${collapse}_collapse`], function(data) {
            let val = (parseInt(data[`${collapse}_collapse`]) == 1 ? 1 : 0);
            if(e.triggerName !== "sheet:opened"){
                val = (val == 1 ? 0 : 1);
            }
            if(val){
                $20(`#${collapse}_collapse`).addClass("collapsed");
            } else {
                $20(`#${collapse}_collapse`).removeClass("collapsed");
            }
            setAttrs({
                [`${collapse}_collapse`]: val
            });
        });
    });
});
// Two-handing support
on(`change:twohanding sheet:opened`, function() {
    getAttrs(["twohanding"], function(data) {
        if(data.twohanding == "on" || data.twohanding == 1){
            $20(".main-hand").addClass("hidden");
            $20(".off-hand").addClass("hidden");
            $20(".hands-slot").removeClass("hidden");
        } else {
            $20(".main-hand").removeClass("hidden");
            $20(".off-hand").removeClass("hidden");
            $20(".hands-slot").addClass("hidden");
        }
    });
});
// Handles trait (dis)advantage colors
traitlist.forEach(trait => {
    on(`change:${trait}_advantage sheet:opened`, function() {
        getAttrs([`${trait}_advantage`], function(values) {
            if(parseInt(values[`${trait}_advantage`]) == 1){
                $20(`.${trait}`).addClass("advantaged-trait");
                $20(`.${trait}`).removeClass("disadvantaged-trait");
            }
            else if(parseInt(values[`${trait}_advantage`]) == -1){
                $20(`.${trait}`).removeClass("advantaged-trait");
                $20(`.${trait}`).addClass("disadvantaged-trait");
            } else {
                $20(`.${trait}`).removeClass("advantaged-trait");
                $20(`.${trait}`).removeClass("disadvantaged-trait");
            }
        });
    });
});
// Rest point maximum
on(`change:character_level sheet:opened`, function() {
    getAttrs(["character_level"], function(data) {
        setAttrs({
            rest_max: Math.ceil(parseInt(data.character_level || 1)/3).toString() + " max"
        });
    });
});
// Equipment slot maximum
on(`change:equipslots_lu change:character_level sheet:opened`, function() {
    getAttrs(["equipslots_lu", "character_level"], function(data) {
        setAttrs({
            equipslots_max: LEcalc(data.character_level, data.equipslots_lu) + 5
        });
    });
});
/* Repeating abilities */
on('clicked:repeating_abilities:collapse', function() {
    getAttrs(["repeating_abilities_ability_collapse"], function(data) {
        setAttrs({
            repeating_abilities_ability_collapse: (parseInt(data.repeating_abilities_ability_collapse) === 1 ? 0 : 1)
        });
    });
});
on('clicked:repeating_abilities:load', function() {
    getAttrs(["repeating_abilities_ability_load"], function(data) {
        let val = (parseInt(data.repeating_abilities_ability_load) === 1);
        setAttrs({
            repeating_abilities_ability_load: (val ? 0 : 1)
        });
    })
});
on('clicked:repeating_abilities:layout', function() {
    getAttrs(["repeating_abilities_ability_layout"], function(data) {
        let result = parseInt(data.repeating_abilities_ability_layout) + 1;
        result = (result > 2 ? 1 : result);
        setAttrs({
            repeating_abilities_ability_collapse: 0, //open the ability
            repeating_abilities_ability_layout: result
        });
    })
});
on("change:outside_category", function() { // The outside-the-repeating-category dropdown select for categorization
    getAttrs(["outside_category"], function(data) {
        setAttrs({
            outside_ability_category: data.outside_category
        });
    });
});
on("change:repeating_abilities:category", function() {
    getAttrs(["repeating_abilities_category"], function(data) {
        setAttrs({
            repeating_abilities_ability_category: data.repeating_abilities_category
        });
    });
});
























attacklist.forEach(attack => {
    on(`clicked:repeating_abilities:${attack}`, function() {
        getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_global_damage", "ability_global_critmin", attack, "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", `repeating_abilities_ability_${attack}_range`, "repeating_abilities_ability_damage_type"], function(data) {
            let rollData = {
                "bonus": parseInt(data[attack]) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
                "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
                "character_name": data.character_name,
                "roll_name": data.repeating_abilities_ability_name,
                "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
                "brutal_damage": data.repeating_abilities_ability_brutal,
                "range": data[`repeating_abilities_ability_${attack}_range`],
                "crit_min": data.ability_global_critmin,
                "damage_type": data.repeating_abilities_ability_damage_type,
                "is_attack": true,
                "hidden_roll": data.hidden_roll,
                "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
                "attack_type": capitalizeFirstLetter(attack),
            }
            _makeRoll(rollData);
        })
    });
});














/*on('clicked:repeating_abilities:melee', function() {
    getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_global_damage", "ability_global_critmin", "melee", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_melee_range", "repeating_abilities_ability_damage_type"], function(data) {
        
        console.log(parseInt(data.melee));
        console.log(LEcalc(data.character_level, parseInt(data.melee)));
        console.log(parseInt(data.modifier));
        console.log(parseInt(data.ability_accuracy));

        let rollData = {
            "bonus": parseInt(data.melee) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
            "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
            "character_name": data.character_name,
            "roll_name": data.repeating_abilities_ability_name,
            "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
            "brutal_damage": data.repeating_abilities_ability_brutal,
            "range": data.repeating_abilities_ability_melee_range,
            "crit_min": data.ability_global_critmin,
            "damage_type": data.repeating_abilities_ability_damage_type,
            "is_attack": true,
            "hidden_roll": data.hidden_roll,
            "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
            "attack_type": "Melee",
        }
        console.log(rollData); //TPTODO
        _makeRoll(rollData);
    })
});

on('clicked:repeating_abilities:ranged', function() {
    getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_global_damage", "ability_global_critmin", "ranged", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_ranged_range", "repeating_abilities_ability_damage_type"], function(data) {
        
        let rollData = {
            "bonus": parseInt(data.ranged) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
            "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
            "character_name": data.character_name,
            "roll_name": data.repeating_abilities_ability_name,
            "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
            "brutal_damage": data.repeating_abilities_ability_brutal,
            "range": data.repeating_abilities_ability_ranged_range,
            "crit_min": data.ability_global_critmin,
            "damage_type": data.repeating_abilities_ability_damage_type,
            "is_attack": true,
            "hidden_roll": data.hidden_roll,
            "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
            "attack_type": "Ranged",
        }
        console.log(rollData); //TPTODO
        _makeRoll(rollData);
    })
});

on('clicked:repeating_abilities:thrown', function() {
    getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_global_damage", "ability_global_critmin", "thrown", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_thrown_range", "repeating_abilities_ability_damage_type"], function(data) {
        
        let rollData = {
            "bonus": parseInt(data.thrown) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
            "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
            "character_name": data.character_name,
            "roll_name": data.repeating_abilities_ability_name,
            "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
            "brutal_damage": data.repeating_abilities_ability_brutal,
            "range": data.repeating_abilities_ability_thrown_range,
            "crit_min": data.ability_global_critmin,
            "damage_type": data.repeating_abilities_ability_damage_type,
            "is_attack": true,
            "hidden_roll": data.hidden_roll,
            "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
            "attack_type": "Thrown",
        }
        console.log(rollData); //TPTODO
        _makeRoll(rollData);
    })
});

on('clicked:repeating_abilities:spell', function() {
    getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_minimum", "ability_global_damage", "ability_global_critmin", "spell", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_spell_range", "repeating_abilities_ability_damage_type"], function(data) {
        
        let rollData = {
            "bonus": parseInt(data.spell) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
            "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
            "character_name": data.character_name,
            "roll_name": data.repeating_abilities_ability_name,
            "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
            "brutal_damage": data.repeating_abilities_ability_brutal,
            "range": data.repeating_abilities_ability_spell_range,
            "crit_min": data.ability_global_critmin,
            "damage_type": data.repeating_abilities_ability_damage_type,
            "is_attack": true,
            "hidden_roll": data.hidden_roll,
            "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
            "attack_type": "Spellstrike",
        }
        console.log(rollData); //TPTODO
        _makeRoll(rollData);
    })
});

on('clicked:repeating_abilities:unarmed', function() {
    getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_minimum", "ability_global_damage", "ability_global_critmin", "unarmed", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_unarmed_range", "repeating_abilities_ability_damage_type"], function(data) {
        
        let rollData = {
            "bonus": parseInt(data.unarmed) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
            "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
            "character_name": data.character_name,
            "roll_name": data.repeating_abilities_ability_name,
            "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
            "brutal_damage": data.repeating_abilities_ability_brutal,
            "crit_min": data.ability_global_critmin,
            "damage_type": data.repeating_abilities_ability_damage_type,
            "is_attack": true,
            "hidden_roll": data.hidden_roll,
            "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
            "attack_type": "Unarmed",
        }
        console.log(rollData); //TPTODO
        _makeRoll(rollData);
    })
});

on('clicked:repeating_abilities:effect', function() {
    getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_minimum", "ability_global_damage", "ability_global_critmin", "effect", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_unarmed_range", "repeating_abilities_ability_damage_type"], function(data) {
        
        let rollData = {
            "bonus": parseInt(data.effect) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
            "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
            "character_name": data.character_name,
            "roll_name": data.repeating_abilities_ability_name,
            "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
            "brutal_damage": data.repeating_abilities_ability_brutal,
            "range": data.repeating_abilities_ability_unarmed_range,
            "crit_min": data.ability_global_critmin,
            "damage_type": data.repeating_abilities_ability_damage_type,
            "is_attack": true,
            "hidden_roll": data.hidden_roll,
            "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
            "attack_type": "Effect",
        }
        console.log(rollData); //TPTODO
        _makeRoll(rollData);
    })
});

on('clicked:repeating_abilities:ability', function() {
    getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_minimum", "ability_global_damage", "ability_global_critmin", "ability", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_unarmed_range", "repeating_abilities_ability_damage_type"], function(data) {
        
        let rollData = {
            "bonus": parseInt(data.ability) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
            "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
            "character_name": data.character_name,
            "roll_name": data.repeating_abilities_ability_name,
            "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
            "brutal_damage": data.repeating_abilities_ability_brutal,
            "range": data.repeating_abilities_ability_unarmed_range,
            "crit_min": data.ability_global_critmin,
            "damage_type": data.repeating_abilities_ability_damage_type,
            "is_attack": true,
            "hidden_roll": data.hidden_roll,
            "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
            "attack_type": "Ability",
        }
        console.log(rollData); //TPTODO
        _makeRoll(rollData);
    })
});

on('clicked:repeating_abilities:rune', function() {
    getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_minimum", "ability_global_damage", "ability_global_critmin", "rune", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_unarmed_range", "repeating_abilities_ability_damage_type"], function(data) {
        
        let rollData = {
            "bonus": parseInt(data.rune) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
            "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
            "character_name": data.character_name,
            "roll_name": data.repeating_abilities_ability_name,
            "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
            "brutal_damage": data.repeating_abilities_ability_brutal,
            "range": data.repeating_abilities_ability_unarmed_range,
            "crit_min": data.ability_global_critmin,
            "damage_type": data.repeating_abilities_ability_damage_type,
            "is_attack": true,
            "hidden_roll": data.hidden_roll,
            "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
            "attack_type": "Rune",
        }
        console.log(rollData); //TPTODO
        _makeRoll(rollData);
    })
});

on('clicked:repeating_abilities:environment', function() {
    getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_minimum", "ability_global_damage", "ability_global_critmin", "environment", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_unarmed_range", "repeating_abilities_ability_damage_type"], function(data) {
        
        let rollData = {
            "bonus": parseInt(data.environment) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
            "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
            "character_name": data.character_name,
            "roll_name": data.repeating_abilities_ability_name,
            "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
            "brutal_damage": data.repeating_abilities_ability_brutal,
            "range": data.repeating_abilities_ability_unarmed_range,
            "crit_min": data.ability_global_critmin,
            "damage_type": data.repeating_abilities_ability_damage_type,
            "is_attack": true,
            "hidden_roll": data.hidden_roll,
            "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
            "attack_type": "Environment",
        }
        console.log(rollData); //TPTODO
        _makeRoll(rollData);
    })
}); */






// CHATGPT SLOP
const abilityMap = [
    { action: 'allCategory',           value: ''              }, // default, no CSS rule → shows everything
    { action: 'weaponCategory',        value: 'Weapon'         },
    { action: 'spellCategory',         value: 'Spell'          },
    { action: 'classAbilityCategory',  value: 'ClassAbility'  },
    { action: 'speciesAbilityCategory',value: 'SpeciesAbility'},
    { action: 'loreAbilityCategory',   value: 'LoreAbility'   },
    { action: 'equipmentCategory',     value: 'Equipment'      },
    { action: 'inventoryCategory',     value: 'Inventory'      },
];

abilityMap.forEach(({ action, value }) => {
    on(`clicked:${action}`, () => {
    $20(".ability-category").removeClass("Weapon");
    $20(".ability-category").removeClass("Spell");
    $20(".ability-category").removeClass("ClassAbility");
    $20(".ability-category").removeClass("SpeciesAbility");
    $20(".ability-category").removeClass("LoreAbility");
    $20(".ability-category").removeClass("Equipment");
    $20(".ability-category").removeClass("Inventory");
    if(action !== "allCategory"){
        $20(".ability-category").addClass(value);
    }
    $20(`.allCategory`).removeClass("selected");
    $20(`.weaponCategory`).removeClass("selected");
    $20(`.spellCategory`).removeClass("selected");
    $20(`.classAbilityCategory`).removeClass("selected");
    $20(`.speciesAbilityCategory`).removeClass("selected");
    $20(`.loreAbilityCategory`).removeClass("selected");
    $20(`.equipmentCategory`).removeClass("selected");
    $20(`.inventoryCategory`).removeClass("selected");
    $20(`.${action}`).addClass("selected");
    });
});
    </script>
