<!-- Roll20 character sheet created by Thomas Pohler -->
<!-- for the TTRPG Legends Unbound, created by Kurt Knudsen and co-created by Thomas Pohler -->



<!-- DEVELOPER NOTES: -->
<!-- Variables are stored between sessions via the "name" attribute -->
<!-- As of this writing, no direct JavaScript manipulation is allowed outside of .addClass()/.removeClass()/.toggleClass()/.on() -->





<div id="full_sheet">
    
    
    
    
    
    <!------------>
    <!-- HEADER -->
    <!------------>
    
    <!-- Controls which page is currently active -->
    <input type="hidden" name="attr_sheet_tab" value="main" />
    <div id="tab_holder" class="row">
        <button type="action" name="act_main"><span>Character</span></button>
        <button type="action" name="act_equipment"><span>Equipment</span></button>
        <button type="action" name="act_level"><span>Level-Up</span></button>
        <button type="action" name="act_roleplay"><span>Roleplay</span></button>
        <button type="action" name="act_cheatsheet"><span>Cheatsheet</span></button>
    </div>
    
    
    
    
    
    <!---------------->
    <!-- PAGE: MAIN -->
    <!---------------->
    <div id="page_main" class="row">
    
        <div id="main_page_main"> <!-- column 1 of main page -->
            <div class="container-style main-width">
                <input type="hidden" name="attr_character_collapse" value="0" />
                <div class="header-row">
                    <button type="action" name="act_character_collapse" title="Open/Close"></button>
                    <span>Character</span>
                </div>
                
                <div class="collapsible" id="character_collapse">
                    <div class="header-hr"></div>

                    <div class="row">
                        <div class="col3">
                            <span>NAME</span>
                            <input type="text" name="attr_character_name"/>
                        </div>
                        <div class="col1">
                            <span>PLAYER</span>
                            <input type="text" name="attr_character_player" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col3">
                            <span>SPECIES</span>
                            <input type="text" name="attr_character_species" />
                        </div>
                        <div class="col1">
                            <span>SIZE</span>
                            <input type="text" name="attr_character_size" />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col3">
                            <span>CLASS(ES)</span>
                            <input type="text" name="attr_character_class" />
                        </div>
                        <div class="col1">
                            <span>LEVEL</span>
                            <input type="number" name="attr_character_level" value="1"/>
                        </div>
                    </div>
                    <div class="row">
                        <div>
                            <span class="accent-text">DESCRIPTION</span>
                            <textarea class="resize" name="attr_appearance_text"></textarea> <!-- TPTODO move to roleplay -->
                        </div>
                    </div>
                </div>
            </div>
    
    
    
            <div class="container-style main-width">
                <div class="header-row">
                    <button type="action" name="act_traits_collapse" title="Open/Close"></button>
                    <span>Traits</span>
                </div>
                
                <div class="collapsible" id="traits_collapse">
                    <div class="header-hr"></div>

                    <div class="row">
                        <div>
                            <span>ADVANTAGE</span>
                            <input type="number" name="attr_trait_advantage" value="0" />
                        </div>
                        <div>
                            <span>MODIFIER</span>
                            <input type="number" name="attr_trait_modifier" value="0" />
                        </div>
                        
                        <div>
                            <span>CRIT. RANGE</span>
                            <input type="number" name="attr_trait_minimum" value="20" />
                        </div>
                    </div>

                    <div class="horizontal-traits">
                        <div class="row">
                            <button type="action" class="agility" name="act_agility"><input style="width: 25px !important;" type="number" value="0" name="attr_agility" readonly="true"/><span>Agility</span></button>
                            <button type="action" class="apothecary" name="act_apothecary"><input style="width: 25px !important;" type="number" value="0" name="attr_apothecary" readonly="true"/><span>Apothecary</span></button>
                            <button type="action" class="bargain" name="act_bargain"><input style="width: 25px !important;" type="number" value="0" name="attr_bargain" readonly="true"/><span>Bargain</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="communication" name="act_communication"><input style="width: 25px !important;" type="number" value="0" name="attr_communication" readonly="true"/><span>Communication</span></button>
                            <button type="action" class="convince" name="act_convince"><input style="width: 25px !important;" type="number" value="0" name="attr_convince" readonly="true"/><span>Convince</span></button>
                            <button type="action" class="detection" name="act_detection"><input style="width: 25px !important;" type="number" value="0" name="attr_detection" readonly="true"/><span>Detection</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="engineering" name="act_engineering"><input style="width: 25px !important;" type="number" value="0" name="attr_engineering" readonly="true"/><span>Engineering</span></button>
                            <button type="action" class="entertainment" name="act_entertainment"><input style="width: 25px !important;" type="number" value="0" name="attr_entertainment" readonly="true"/><span>Entertainment</span></button>
                            <button type="action" class="etiquette" name="act_etiquette"><input style="width: 25px !important;" type="number" value="0" name="attr_etiquette" readonly="true"/><span>Etiquette</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="hands" name="act_hands"><input style="width: 25px !important;" type="number" value="0" name="attr_hands" readonly="true"/><span>Hands</span></button>
                            <button type="action" class="history" name="act_history"><input style="width: 25px !important;" type="number" value="0" name="attr_history" readonly="true"/><span>History</span></button>
                            <button type="action" class="intuition" name="act_intuition"><input style="width: 25px !important;" type="number" value="0" name="attr_intuition" readonly="true"/><span>Intuition</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="magic" name="act_magic"><input style="width: 25px !important;" type="number" value="0" name="attr_magic" readonly="true"/><span>Magic</span></button>
                            <button type="action" class="might" name="act_might"><input style="width: 25px !important;" type="number" value="0" name="attr_might" readonly="true"/><span>Might</span></button>
                            <button type="action" class="navigation" name="act_navigation"><input style="width: 25px !important;" type="number" value="0" name="attr_navigation" readonly="true"/><span>Navigation</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="perseverance" name="act_perseverance"><input style="width: 25px !important;" type="number" value="0" name="attr_perseverance" readonly="true"/><span>Perseverance</span></button>
                            <button type="action" class="profession" name="act_profession"><input style="width: 25px !important;" type="number" value="0" name="attr_profession" readonly="true"/><span>Profession</span></button>
                            <button type="action" class="religion" name="act_religion"><input style="width: 25px !important;" type="number" value="0" name="attr_religion" readonly="true"/><span>Religion</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="soothe" name="act_soothe"><input style="width: 25px !important;" type="number" value="0" name="attr_soothe" readonly="true"/><span>Soothe</span></button>
                            <button type="action" class="stealth" name="act_stealth"><input style="width: 25px !important;" type="number" value="0" name="attr_stealth" readonly="true"/><span>Stealth</span></button>
                            <button type="action" class="threat" name="act_threat"><input style="width: 25px !important;" type="number" value="0" name="attr_threat" readonly="true"/><span>Threat</span></button>
                        </div>
                        <div class="row bottom-padding-6px">
                            <button class="invis"></button>
                            <button type="action" class="wilderness" name="act_wilderness"><input style="width: 25px !important;" type="number" value="0" name="attr_wilderness" readonly="true"/><span>Wilderness</span></button>
                            <button class="invis"></button>
                        </div>
                    </div>

                    <div class="vertical-traits hidden">
                        <div class="row">
                            <button type="action" class="agility" name="act_agility"><input style="width: 25px !important;" type="number" value="0" name="attr_agility" readonly="true"/><span>Agility</span></button>
                            <button type="action" class="entertainment" name="act_entertainment"><input style="width: 25px !important;" type="number" value="0" name="attr_entertainment" readonly="true"/><span>Entertainment</span></button>
                            <button type="action" class="perseverance" name="act_perseverance"><input style="width: 25px !important;" type="number" value="0" name="attr_perseverance" readonly="true"/><span>Perseverance</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="apothecary" name="act_apothecary"><input style="width: 25px !important;" type="number" value="0" name="attr_apothecary" readonly="true"/><span>Apothecary</span></button>
                            <button type="action" class="etiquette" name="act_etiquette"><input style="width: 25px !important;" type="number" value="0" name="attr_etiquette" readonly="true"/><span>Etiquette</span></button>
                            <button type="action" class="profession" name="act_profession"><input style="width: 25px !important;" type="number" value="0" name="attr_profession" readonly="true"/><span>Profession</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="bargain" name="act_bargain"><input style="width: 25px !important;" type="number" value="0" name="attr_bargain" readonly="true"/><span>Bargain</span></button>
                            <button type="action" class="hands" name="act_hands"><input style="width: 25px !important;" type="number" value="0" name="attr_hands" readonly="true"/><span>Hands</span></button>
                            <button type="action" class="religion" name="act_religion"><input style="width: 25px !important;" type="number" value="0" name="attr_religion" readonly="true"/><span>Religion</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="communication" name="act_communication"><input style="width: 25px !important;" type="number" value="0" name="attr_communication" readonly="true"/><span>Communication</span></button>
                            <button type="action" class="history" name="act_history"><input style="width: 25px !important;" type="number" value="0" name="attr_history" readonly="true"/><span>History</span></button>
                            <button type="action" class="soothe" name="act_soothe"><input style="width: 25px !important;" type="number" value="0" name="attr_soothe" readonly="true"/><span>Soothe</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="convince" name="act_convince"><input style="width: 25px !important;" type="number" value="0" name="attr_convince" readonly="true"/><span>Convince</span></button>
                            <button type="action" class="intuition" name="act_intuition"><input style="width: 25px !important;" type="number" value="0" name="attr_intuition" readonly="true"/><span>Intuition</span></button>
                            <button type="action" class="stealth" name="act_stealth"><input style="width: 25px !important;" type="number" value="0" name="attr_stealth" readonly="true"/><span>Stealth</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="detection" name="act_detection"><input style="width: 25px !important;" type="number" value="0" name="attr_detection" readonly="true"/><span>Detection</span></button>
                            <button type="action" class="magic" name="act_magic"><input style="width: 25px !important;" type="number" value="0" name="attr_magic" readonly="true"/><span>Magic</span></button>
                            <button type="action" class="threat" name="act_threat"><input style="width: 25px !important;" type="number" value="0" name="attr_threat" readonly="true"/><span>Threat</span></button>
                        </div>
                        <div class="row">
                            <button type="action" class="engineering" name="act_engineering"><input style="width: 25px !important;" type="number" value="0" name="attr_engineering" readonly="true"/><span>Engineering</span></button>
                            <button type="action" class="might" name="act_might"><input style="width: 25px !important;" type="number" value="0" name="attr_might" readonly="true"/><span>Might</span></button>
                            <button type="action" class="wilderness" name="act_wilderness"><input style="width: 25px !important;" type="number" value="0" name="attr_wilderness" readonly="true"/><span>Wilderness</span></button>
                        </div>
                        <div class="row bottom-padding-6px">
                            <button class="invis"></button>
                            <button type="action" class="navigation" name="act_navigation"><input style="width: 25px !important;" type="number" value="0" name="attr_navigation" readonly="true"/><span>Navigation</span></button>
                            <button class="invis"></button>
                        </div>
                    </div>
                </div>
            </div>
    
    
    
            <div class="container-style main-width">
                <div class="header-row">
                    <button type="action" name="act_stats_collapse" title="Open/Close"></button>
                    <span>Stats</span>
                </div>
                
                <div class="collapsible" id="stats_collapse">
                    <div class="header-hr"></div>

                    <div class="row">
                        <div class="hr"></div>
                        <span class="text-color">CHARACTER</span>
                        <div class="hr"></div>
                    </div>
    
                    <div class="row">
                        <div class="col1">
                            <span>Health</span>
                            <input type="number" name="attr_health" />
                            <input type="number" name="attr_health_max" />
                        </div>
                        <div class="col1">
                            <span>Mana</span>
                            <input type="number" name="attr_mana" />
                            <input type="number" name="attr_mana_max" />
                        </div>
                        <div class="col1">
                            <span>Fatigue</span>
                            <input type="number" name="attr_fatigue" value="0" />
                        </div>
                        <div class="col1">
                            <span>Gold</span>
                            <input type="number" name="attr_gold" value="0" />
                        </div>
                    </div>

                    <div class="row">
                        <div>
                            <span>Death Stacks</span>
                            <input type="number" name="attr_deathstacks" value="3" />
                            <input type="number" name="attr_deathstacks_max" value="3" />
                        </div>
                        <div>
                            <span>Rest Points</span>
                            <input type="number" name="attr_rest" value="1" />
                            <input type="number" name="attr_rest_max" readonly="true" value="1" />
                        </div>
                        <div>
                            <span>Equip. Slots</span>
                            <input type="number" name="attr_equipslots" value="0" />
                            <input type="number" name="attr_equipslots_max" readonly="true" value="5" />
                        </div>
                    </div>

                    <div class="row top-padding-6px">
                        <div class="hr"></div>
                        <span class="text-color">STATUSES / EQUIPMENT</span>
                        <div class="hr"></div>
                    </div>

                    <div class="row">
                        <div>
                            <span>Status 1</span>
                            <input type="text" name="attr_status1" />
                        </div>
                        <div>
                            <span>Status 2</span>
                            <input type="text" name="attr_status2" />
                        </div>
                        <div>
                            <span>Status 3</span>
                            <input type="text" name="attr_status3" />
                        </div>
                    </div>

                    <div class="row">
                        <div>
                            <span>Left Hand</span>
                            <input type="text" name="attr_lefthand" />
                        </div>
                        <div>
                            <span>Right Hand</span>
                            <input type="text" name="attr_righthand" />
                        </div>
                        <div>
                            <span>Armor</span>
                            <input type="text" name="attr_armor" />
                        </div>
                    </div>

                    <div class="row top-padding-6px">
                        <div class="hr"></div>
                        <span class="text-color">MOVEMENT</span>
                        <div class="hr"></div>
                    </div>
        
                    <div class="row">
                        <div>
                            <span>Walking</span>
                            <input type="number" name="attr_walking" value="5" />
                        </div>
                        <div>
                            <span>Swimming</span>
                            <input type="number" name="attr_swimming" value="3" />
                        </div>
                        <div>
                            <span>Jumping</span>
                            <input type="number" name="attr_jumping" value="3" />
                        </div>
                        <div>
                            <span>Flying</span>
                            <input type="number" name="attr_flying" value="0" />
                        </div>
                        <div>
                            <span>Burrowing</span>
                            <input type="number" name="attr_burrowing" value="0" />
                        </div>
                    </div>

                    <div class="row top-padding-6px">
                        <div class="hr"></div>
                        <span class="text-color">TOLERANCES / WEAKNESSES</span>
                        <div class="hr"></div>
                    </div>

                    <div class="row">
                        <div>
                            <span>Acid</span>
                            <input type="number" readonly="true" value="0" name="attr_acid"/>
                        </div>
                        <div>
                            <span>Cold</span>
                            <input type="number" readonly="true" value="0" name="attr_cold"/>
                        </div>
                        <div>
                            <span>Death</span>
                            <input type="number" readonly="true" value="0" name="attr_death"/>
                        </div>
                        <div>
                            <span>Electric</span>
                            <input type="number" readonly="true" value="0" name="attr_electric"/>
                        </div>
                        <div>
                            <span>Fire</span>
                            <input type="number" readonly="true" value="0" name="attr_fire"/>
                        </div>
                    </div>
                    <div class="row bottom-padding-3px">
                        <div>
                            <span>Light</span>
                            <input type="number" readonly="true" value="0" name="attr_light"/>
                        </div>
                        <div>
                            <span>Physical</span>
                            <input type="number" readonly="true" value="0" name="attr_physical"/>
                        </div>
                        <div>
                            <span>Poison</span>
                            <input type="number" readonly="true" value="0" name="attr_poison"/>
                        </div>
                        <div>
                            <span>Psychic</span>
                            <input type="number" readonly="true" value="0" name="attr_psychic"/>
                        </div>
                        <div>
                            <span>Sonic</span>
                            <input type="number" readonly="true" value="0" name="attr_sonic"/>
                        </div>
                    </div>
                </div>
            </div>
    
    
    
            <div class="container-style main-width">
                <div class="header-row">
                    <button type="action" name="act_dcdefense_collapse" title="Open/Close"></button>
                    <span>Defense</span>
                </div>
                
                <div class="collapsible" id="dcdefense_collapse">
                    <div class="header-hr"></div>

                    <div class="row">
                        <div>
                            <span>ADVANTAGE</span>
                            <input type="number" name="attr_defense_advantage" value="0" />
                        </div>
                        <div>
                            <span>MODIFIER</span>
                            <input type="number" name="attr_defense_modifier" value="0" />
                        </div>
                        
                        <div>
                            <span>CRIT. RANGE</span>
                            <input type="number" name="attr_defense_minimum" value="20" />
                        </div>
                    </div>

                    <div class="row">
                        <button type="action" name="act_melee_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_melee_defense" readonly="true"/><span>Melee</span></button>
                        <button type="action" name="act_ranged_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_ranged_defense" readonly="true"/><span>Ranged</span></button>
                        <!--<button type="action" name="act_thrown_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_thrown_defense" readonly="true"/><span>Thrown</span></button>
                        <button type="action" name="act_unarmed_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_unarmed_defense" readonly="true"/><span>Unarmed</span></button>-->
                        <button type="action" name="act_spell_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_spell_defense" readonly="true"/><span>Spellstrike</span></button>
                    </div>
                    <div class="row">
                        <button type="action" name="act_effect_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_effect_defense" readonly="true"/><span>Effect</span></button>
                        <button type="action" name="act_ability_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_ability_defense" readonly="true"/><span>Ability</span></button>
                        <button type="action" name="act_environment_defense" style="width:112px; text-align:center;"><input style="width: 25px !important;" type="number" value="0" name="attr_environment_defense" readonly="true"/><span>Environment</span></button>
                    </div>
                    <!--<div>
                        <button type="action" name="act_rune_defense"><input style="width: 25px !important;" type="number" value="0" name="attr_rune_defense" readonly="true"/><span>Rune</span></button>
                    </div>-->
                </div>
            </div>
    
    
    
            <div id="ability_container" class="container-style main-width">
                <div class="header-row">
                    <button type="action" class="invis"></button>
                    <span>Abilities / Attacks / Spells</span>
                </div>
                
                <div class="header-hr"></div>

                <div class="row">
                    <div class="hr"></div>
                    <span class="text-color">ATTACK MODS</span>
                    <div class="hr"></div>
                </div>
    
                <div class="row">
                    <div>
                        <span class="accent-text">MELEE</span>
                        <input type="number" name="attr_melee" readonly="true" value="3" />
                    </div>
                    <div>
                        <span class="accent-text">RANGED</span>
                        <input type="number" name="attr_ranged" readonly="true" value="3" />
                    </div>
                    <!--<div>
                        <span class="accent-text">THROWN</span>
                        <input type="number" name="attr_thrown" readonly="true" value="3" />
                    </div>
                    <div>
                        <span class="accent-text">UNARMED</span>
                        <input type="number" name="attr_unarmed" readonly="true" value="3" />
                    </div>-->
                    <div>
                        <span class="accent-text">SPELLSTRIKE</span>
                        <input type="number" name="attr_spell" readonly="true" value="3" />
                    </div>
                </div>
                <div class="row">
                    <div>
                        <span class="accent-text">EFFECT</span>
                        <input type="number" name="attr_effect" readonly="true" value="3" />
                    </div>
                    <div>
                        <span class="accent-text">ABILITY</span>
                        <input type="number" name="attr_ability" readonly="true" value="3" />
                    </div>
                    <!--<div>
                        <span class="accent-text">RUNE</span>
                        <input type="number" name="attr_rune" readonly="true" value="3" />
                    </div>-->
                    <div>
                        <span class="accent-text">ENVIRONMENT</span>
                        <input type="number" name="attr_environment" readonly="true" value="3" />
                    </div>
                </div>

                <div class="row top-padding-6px">
                    <div class="hr"></div>
                    <span class="text-color">CUSTOM MODS</span>
                    <div class="hr"></div>
                </div>
                <div class="row">
                    <div>
                        <span>ADVANTAGE</span>
                        <input type="number" name="attr_ability_advantage" value="0" />
                    </div>
                    <div>
                        <span>ACCURACY</span>
                        <input type="number" name="attr_ability_accuracy" value="0" />
                    </div>
                    <div>
                        <span>CRIT. RANGE</span>
                        <input type="number" name="attr_ability_global_critmin" value="20" />
                    </div>
                    <div>
                        <span>DAMAGE MOD</span>
                        <input type="number" name="attr_ability_global_damage" value="0" />
                    </div>
                </div>
                
                <div class="hr"></div>
    
                <div style="text-align: center;">
                    <span style="font-size:16px;">Hover over any field to see what it does!</span>
                </div>

                <input class="outside-ability-category" type="hidden" name="attr_outside_ability_category" value="1" />
                <span>CATEGORY</span>
                <select class="outside-category" name="attr_outside_category">
                    <option>All</option>
                    <option>Attack</option>
                    <option>Spell</option>
                    <option>Class Ability</option>
                    <option>Species Ability</option>
                    <option>Lore Ability</option>
                    <option>Equipment</option>
                </select>

                <div class="hr"></div>
                <div class="hr"></div>
                <div class="hr"></div>
                <div class="hr"></div>
                <div class="hr"></div>
                
                <fieldset class="repeating_abilities">
                    <input class="ability-category" type="hidden" name="attr_ability_category" value="1" />
                    <div class="ability-full">

                        <div class="hr"></div>
                        <input class="ability-layout" type="hidden" name="attr_ability_layout" value="1" />
                        <div class="ability main-width">

                            <input class="ability-color" type="hidden" name="attr_ability_color" value="1" />
                            <div class="ability-header">
                                <button type="action" name="act_collapse" title="Show/Hide Details"></button>
        
                                <input type="text" class="ability-name" name="attr_ability_name" title="Name" />
                
                                <div class="ability-uses hidden">
                                    <input type="number" name="attr_ability_uses" title="Remaining Uses" style="width: 50px !important"/>
                                    <span>/</span>
                                    <input type="number" name="attr_ability_uses_max" title="Max Uses" style="width: 50px !important" />
                                </div>
                
                                <button type="action" name="act_layout" title="Change Layout"></button>
                            </div>
                    
                            <input class="ability-collapse" type="hidden" name="attr_ability_collapse" value="1" />
                            <div class="content">
                                <div class="ability-attack hidden">
                                    <div class="ability-attack-header">
                                        <input type="number" name="attr_ability_damage" title="Damage" />
                                        <input type="text" name="attr_ability_damage_type" title="Damage Type" style="width: 200px !important"/> <!--TPTODO-->
                                        <span>+</span>
                                        <input type="number" name="attr_ability_brutal" title="Brutal Damage" />
                                        
                                        <input class="ability-load" type="hidden" name="attr_ability_load" />
                                        <button type="action" class="load-button hidden" name="act_load" title="Is your weapon loaded?" >
                                            <span class="loaded">Loaded</span>
                                            <span class="unloaded">Unloaded</span>
                                        </button>
                                    </div>
                    
                                    <div class="row ability-attack-content">
                                        <div class="melee hidden">
                                            <button type="action" name="act_melee" title="Make a melee attack!"><span>Melee</span></button>
                                            <input type="number" name="attr_ability_melee_range" title="Melee Range"/>
                                        </div>
                                        <div class="ranged hidden">
                                            <button type="action" name="act_ranged" title="Make a ranged attack!"><span>Ranged</span></button>
                                            <input type="number" name="attr_ability_ranged_range" title="Ranged Range"/>
                                        </div>
                                        <!--<div class="thrown hidden">
                                            <button type="action" name="act_thrown" title="Make a thrown attack!"><span>Thrown</span></button>
                                            <input type="number" name="attr_ability_thrown_range" title="Thrown Range"/>
                                        </div>
                                        <div class="unarmed hidden">
                                            <button type="action" name="act_unarmed" title="Make an unarmed attack!"><span>Unarmed</span></button>
                                            <input type="number" name="attr_ability_unarmed_range" title="Unarmed Range"/>
                                        </div>-->
                                        <div class="spell hidden">
                                            <button type="action" name="act_spell" title="Make a spell attack!"><span>Spellstrike</span></button>
                                            <input type="number" name="attr_ability_spell_range" title="Spellstrike Range"/>
                                        </div>
                                        <div class="effect hidden">
                                            <button type="action" name="act_effect" title="Make an effect attack!"><span>Effect</span></button>
                                            <input type="number" name="attr_ability_effect_range" title="Effect Range"/>
                                        </div>
                                        <div class="ability hidden">
                                            <button type="action" name="act_ability" title="Make an ability attack!"><span>Ability</span></button>
                                            <input type="number" name="attr_ability_ability_range" title="Ability Range"/>
                                        </div>
                                        <!--<div class="rune hidden">
                                            <button type="action" name="act_rune" title="Make a rune attack!"><span>Rune</span></button>
                                            <input type="number" name="attr_ability_rune_range" title="Rune Range"/>
                                        </div>-->
                                        <div class="environment hidden">
                                            <button type="action" name="act_environment" title="Make an environment attack!"><span>Environment</span></button>
                                            <input type="number" name="attr_ability_environment_range" title="Environment Range"/>
                                        </div>
                                    </div>
                                </div>
                        
                                <div class="ability-description hidden">
                                    <textarea name="attr_ability_text" title="Ability Description"></textarea>
                                </div>
                            </div>
                            <div class="settings">
                                <div class="row">
                                    <div></div>
                                    <div>
                                        <span>CATEGORY</span>
                                        <select class="category" name="attr_category">
                                            <option>Attack</option>
                                            <option>Spell</option>
                                            <option>Class Ability</option>
                                            <option>Species Ability</option>
                                            <option>Lore Ability</option>
                                            <option>Equipment</option>
                                        </select>
                                    </div>
                                    <div></div>
                                </div>
                                <div class="row">
                                    <div></div>
                                    <div>
                                        <span>COLOR</span>
                                        <select name="attr_color">
                                            <option>Default</option>
                                            <option>Red</option>
                                            <option>Green</option>
                                            <option>Blue</option>
                                            <option>Purple</option>
                                            <option>Pink</option>
                                        </select>
                                    </div>
                                    <div></div>
                                </div>
                                <div class="row">
                                    <div>
                                        <span>Has Description? </span><input type="checkbox" class="hasdescription" name="attr_ability_hasdescription" checked="true"/>
                                    </div>
                                    <div>
                                        <span>Has Uses? </span><input type="checkbox" class="hasuses" name="attr_ability_hasuses"/>
                                    </div>
                                    <div>
                                        <span>Is Attack? </span><input type="checkbox" class="hasattack" name="attr_ability_hasattack"/>
                                    </div>
                                    <div>
                                        <span>Has Ammo? </span><input type="checkbox" class="hasammo" name="attr_ability_hasammo"/>
                                    </div>
                                </div>
                                <div class="row">
                                    <div>
                                        <span>Melee: </span><input type="checkbox" class="hasmelee" name="attr_ability_hasmelee"/>
                                    </div>
                                    <div>
                                        <span>Ranged: </span><input type="checkbox" class="hasranged" name="attr_ability_hasranged"/>
                                    </div>
                                    <!--<div>
                                        <span>Thrown: </span><input type="checkbox" class="hasthrown" name="attr_ability_hasthrown"/>
                                    </div>
                                    <div>
                                        <span>Unarmed: </span><input type="checkbox" class="hasunarmed" name="attr_ability_hasunarmed"/>
                                    </div>-->
                                    <div>
                                        <span>Spellstrike: </span><input type="checkbox" class="hasspell" name="attr_ability_hasspell"/>
                                    </div>
                                </div>
                                <div class="row">
                                    <div>
                                        <span>Effect: </span><input type="checkbox" class="haseffect" name="attr_ability_haseffect"/>
                                    </div>
                                    <div>
                                        <span>Ability: </span><input type="checkbox" class="hasability" name="attr_ability_hasability"/>
                                    </div>
                                    <!--<div>
                                        <span>Rune: </span><input type="checkbox" class="hasrune" name="attr_ability_hasrune"/>
                                    </div>-->
                                    <div>
                                        <span>Environment: </span><input type="checkbox" class="hasenvironment" name="attr_ability_hasenvironment"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </fieldset>
            </div>
        </div>
    
    
    
        <div id="main_page_right_sidebar"> <!-- column 2 of main page -->
            <div id="global_mod_box" class="container-style">
                <span class="text-color">GLOBAL MODS</span>
                <div class="hr"></div>
                <div>
                    <span>ADVANTAGE</span>
                    <input type="number" name="attr_advantage" value="0" />
                </div>
                <div>
                    <span>MODIFIER</span>
                    <input type="number" name="attr_modifier" value="0" />
                </div>
                <div>
                    <span>FD-ONLY ROLL</span>
                    <input type="checkbox" name="attr_hidden_roll">
                </div>
            </div>

            <div id="action_tracker_box" class="container-style">
                <span class="text-color">ACTION TRACKER</span>
                <div class="hr"></div>
                <div>
                    <span>MAIN ACTIONS</span>
                    <div class="centered-row">
                        <div>
                            <input type="checkbox">
                            <input type="checkbox">
                        </div>
                    </div>
                </div>
                <div>
                    <span>TACTICAL ACTIONS</span>
                    <div class="centered-row">
                        <div>
                            <input type="checkbox">
                            <input type="checkbox">
                        </div>
                    </div>
                </div>
            </div>
    
            <div id="sheet_settings_box" class="container-style">
                <span class="text-color">SHEET SETTINGS</span>
                <div class="hr"></div>
                <div>
                    <span>TRAIT DIRECTION</span>
                    <select name="attr_settings_traitdirection">
                        <option>Horizontal</option>
                        <option>Vertical</option>
                    </select>
                </div>
                <div id="sheet_color">
                    <span>COLOR</span>
                    <select name="attr_settings_color">
                        <option>Default</option>
                        <option>Red</option>
                        <option>Green</option>
                        <option>Blue</option>
                        <option>Purple</option>
                        <option>Pink</option>
                    </select>
                </div>
            </div>
        </div>
        
    
    
    </div> <!-- end: #page-main -->
    
    
    
    
    
    <!----------------->
    <!-- PAGE: LEVEL -->
    <!----------------->
    <div id="page_level" class="hidden">

        <div class="container-style main-width bottom-padding-4px">
            <div class="row">
                <div class="hr"></div>
                <span>ROLEPLAY</span>
                <div class="hr"></div>
            </div>

            <div class="horizontal-traits">
                <div class="row trait-row">
                    <div>
                        <span>Agility</span>
                        <div class="row">
                            <select name="attr_agility_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_agility_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Apothecary</span>
                        <div class="row">
                            <select name="attr_apothecary_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_apothecary_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Bargain</span>
                        <div class="row">
                            <select name="attr_bargain_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_bargain_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Communication</span>
                        <div class="row">
                            <select name="attr_communication_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_communication_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Convince</span>
                        <div class="row">
                            <select name="attr_convince_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_convince_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Detection</span>
                        <div class="row">
                            <select name="attr_detection_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_detection_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Engineering</span>
                        <div class="row">
                            <select name="attr_engineering_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_engineering_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Entertainment</span>
                        <div class="row">
                            <select name="attr_entertainment_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_entertainment_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Etiquette</span>
                        <div class="row">
                            <select name="attr_etiquette_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_etiquette_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Hands</span>
                        <div class="row">
                            <select name="attr_hands_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_hands_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>History</span>
                        <div class="row">
                            <select name="attr_history_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_history_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Intuition</span>
                        <div class="row">
                            <select name="attr_intuition_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_intuition_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Magic</span>
                        <div class="row">
                            <select name="attr_magic_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_magic_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Might</span>
                        <div class="row">
                            <select name="attr_might_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_might_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Navigation</span>
                        <div class="row">
                            <select name="attr_navigation_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_navigation_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Perseverance</span>
                        <div class="row">
                            <select name="attr_perseverance_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_perseverance_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Profession</span>
                        <div class="row">
                            <select name="attr_profession_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_profession_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Religion</span>
                        <div class="row">
                            <select name="attr_religion_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_religion_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Soothe</span>
                        <div class="row">
                            <select name="attr_soothe_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_soothe_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Stealth</span>
                        <div class="row">
                            <select name="attr_stealth_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_stealth_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Threat</span>
                        <div class="row">
                            <select name="attr_threat_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_threat_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div class="invis">
                        <span>Hidden</span>
                        <div class="row">
                            <select>
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number"/>
                        </div>
                    </div>
                    <div>
                        <span>Wilderness</span>
                        <div class="row">
                            <select name="attr_wilderness_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_wilderness_lu"/>
                        </div>
                    </div>
                    <div class="invis">
                        <span>Hidden</span>
                        <div class="row">
                            <select>
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number"/>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="vertical-traits hidden">
                <div class="row trait-row">
                    <div>
                        <span>Agility</span>
                        <div class="row">
                            <select name="attr_agility_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_agility_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Entertainment</span>
                        <div class="row">
                            <select name="attr_entertainment_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_entertainment_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Perseverance</span>
                        <div class="row">
                            <select name="attr_perseverance_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_perseverance_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Apothecary</span>
                        <div class="row">
                            <select name="attr_apothecary_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_apothecary_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Etiquette</span>
                        <div class="row">
                            <select name="attr_etiquette_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_etiquette_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Profession</span>
                        <div class="row">
                            <select name="attr_profession_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_profession_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Bargain</span>
                        <div class="row">
                            <select name="attr_bargain_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_bargain_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Hands</span>
                        <div class="row">
                            <select name="attr_hands_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_hands_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Religion</span>
                        <div class="row">
                            <select name="attr_religion_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_religion_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Communication</span>
                        <div class="row">
                            <select name="attr_communication_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_communication_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>History</span>
                        <div class="row">
                            <select name="attr_history_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_history_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Soothe</span>
                        <div class="row">
                            <select name="attr_soothe_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_soothe_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Convince</span>
                        <div class="row">
                            <select name="attr_convince_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_convince_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Intuition</span>
                        <div class="row">
                            <select name="attr_intuition_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_intuition_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Stealth</span>
                        <div class="row">
                            <select name="attr_stealth_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_stealth_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Detection</span>
                        <div class="row">
                            <select name="attr_detection_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_detection_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Magic</span>
                        <div class="row">
                            <select name="attr_magic_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_magic_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Threat</span>
                        <div class="row">
                            <select name="attr_threat_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_threat_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div>
                        <span>Engineering</span>
                        <div class="row">
                            <select name="attr_engineering_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_engineering_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Might</span>
                        <div class="row">
                            <select name="attr_might_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_might_lu"/>
                        </div>
                    </div>
                    <div>
                        <span>Wilderness</span>
                        <div class="row">
                            <select name="attr_wilderness_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_wilderness_lu"/>
                        </div>
                    </div>
                </div>
                <div class="row trait-row">
                    <div class="invis">
                        <span>Hidden</span>
                        <div class="row">
                            <select>
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number"/>
                        </div>
                    </div>
                    <div>
                        <span>Navigation</span>
                        <div class="row">
                            <select name="attr_navigation_advantage">
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number" value="0" name="attr_navigation"/>
                        </div>
                    </div>
                    <div class="invis">
                        <span>Hidden</span>
                        <div class="row">
                            <select>
                                <option value="0">None</option>
                                <option value="1">ADV</option>
                                <option value="-1">DisADV</option>
                            </select>
                            <input type="number"/>
                        </div>
                    </div>
                </div>
            </div>
    
            <div class="hr"></div>
    
            <div class="centered-row">
                <span>Extra Languages: </span><input type="number" value="0" name="attr_language"/>
            </div>
            <textarea class="resize" name="attr_languages">Evritung</textarea>
        </div>



        <div class="main-width container-style bottom-padding-5px">
            <div class="row">
                <div class="hr"></div>
                <span>COMBAT</span>
                <div class="hr"></div>
            </div>

            <div class="row">
                <div class="hr"></div>
                <span class="text-color">ATTACK MODS</span>
                <div class="hr"></div>
            </div>

            <div class="row">
                <div>
                    <span>Melee</span>
                    <input type="number" value="0" name="attr_melee_lu"/>
                </div>
                <div>
                    <span>Ranged</span>
                    <input type="number" value="0" name="attr_ranged_lu"/>
                </div>
                <!--<div>
                    <span>Thrown</span>
                    <input type="number" value="0" name="attr_thrown_lu"/>
                </div>
                <div>
                    <span>Unarmed</span>
                    <input type="number" value="0" name="attr_unarmed_lu"/>
                </div>-->
                <div>
                    <span>Spellstrike</span>
                    <input type="number" value="0" name="attr_spell_lu"/>
                </div>
            </div>

            <div class="row">
                <div>
                    <span>Effect</span>
                    <input type="number" value="0" name="attr_effect_lu"/>
                </div>
                <div>
                    <span>Ability</span>
                    <input type="number" value="0" name="attr_ability_lu"/>
                </div>
                <!--<div>
                    <span>Rune</span>
                    <input type="number" value="0" name="attr_rune_lu"/>
                </div>-->
                <div>
                    <span>Environment</span>
                    <input type="number" value="0" name="attr_environment_lu"/>
                </div>
            </div>

            <div class="row">
                <div class="hr"></div>
                <span class="text-color">DEFENSE MODS</span>
                <div class="hr"></div>
            </div>

            <div class="row">
                <div>
                    <span>Melee</span>
                    <input type="number" value="0" name="attr_melee_defense_lu"/>
                </div>
                <div>
                    <span>Ranged</span>
                    <input type="number" value="0" name="attr_ranged_defense_lu"/>
                </div>
                <!--<div>
                    <span>Thrown</span>
                    <input type="number" value="0" name="attr_thrown_defense_lu"/>
                </div>
                <div>
                    <span>Unarmed</span>
                    <input type="number" value="0" name="attr_unarmed_defense_lu"/>
                </div>-->
                <div>
                    <span>Spellstrike</span>
                    <input type="number" value="0" name="attr_spell_defense_lu"/>
                </div>
            </div>

            <div class="row">
                <div>
                    <span>Effect</span>
                    <input type="number" value="0" name="attr_effect_defense_lu"/>
                </div>
                <div>
                    <span>Ability</span>
                    <input type="number" value="0" name="attr_ability_defense_lu"/>
                </div>
                <!--<div>
                    <span>Rune</span>
                    <input type="number" value="0" name="attr_rune_defense_lu"/>
                </div>-->
                <div>
                    <span>Environment</span>
                    <input type="number" value="0" name="attr_environment_defense_lu"/>
                </div>
            </div>

            <div class="centered-row">
                <span>Equipment Slots: </span><input type="number" value="0" name="attr_equipslots_lu"/>
            </div>

            <div class="row">
                <div>
                    <span>Acid</span>
                    <input type="number" value="0"  min="0" max="1" name="attr_acid_lu"/>
                </div>
                <div>
                    <span>Cold</span>
                    <input type="number" value="0" min="0" max="1" name="attr_cold_lu"/>
                </div>
                <div>
                    <span>Death</span>
                    <input type="number" value="0" min="0" max="1" name="attr_death_lu"/>
                </div>
                <div>
                    <span>Electric</span>
                    <input type="number" value="0" min="0" max="1" name="attr_electric_lu"/>
                </div>
                <div>
                    <span>Fire</span>
                    <input type="number" value="0" min="0" max="1" name="attr_fire_lu"/>
                </div>
            </div>
            <div class="row">
                <div>
                    <span>Light</span>
                    <input type="number" value="0" min="0" max="1" name="attr_light_lu"/>
                </div>
                <div>
                    <span>Physical</span>
                    <input type="number" value="0" min="0" max="1" name="attr_physical_lu"/>
                </div>
                <div>
                    <span>Poison</span>
                    <input type="number" value="0" min="0" max="1" name="attr_poison_lu"/>
                </div>
                <div>
                    <span>Psychic</span>
                    <input type="number" value="0" min="0" max="1" name="attr_psychic_lu"/>
                </div>
                <div>
                    <span>Sonic</span>
                    <input type="number" value="0" min="0" max="1" name="attr_sonic_lu"/>
                </div>
            </div>
        </div>
    </div> <!-- end: #page-level -->
    
    
    
    
    
    <!--------------------->
    <!-- PAGE: EQUIPMENT -->
    <!--------------------->
    <div id="page_equipment" class="hidden">

        <!-- Total -->
        <div class="container-style main-width">
            <div style="text-align: center;">
                <span class="header">TOTAL</span>
            </div>
            <div class="row">
                <div>
                    <span>Acid</span>
                    <input type="number" readonly="true" value="0" name="attr_acid"/>
                </div>
                <div>
                    <span>Cold</span>
                    <input type="number" readonly="true" value="0" name="attr_cold"/>
                </div>
                <div>
                    <span>Death</span>
                    <input type="number" readonly="true" value="0" name="attr_death"/>
                </div>
                <div>
                    <span>Electric</span>
                    <input type="number" readonly="true" value="0" name="attr_electric"/>
                </div>
                <div>
                    <span>Fire</span>
                    <input type="number" readonly="true" value="0" name="attr_fire"/>
                </div>
            </div>
            <div class="row">
                <div>
                    <span>Light</span>
                    <input type="number" readonly="true" value="0" name="attr_light"/>
                </div>
                <div>
                    <span>Physical</span>
                    <input type="number" readonly="true" value="0" name="attr_physical"/>
                </div>
                <div>
                    <span>Poison</span>
                    <input type="number" readonly="true" value="0" name="attr_poison"/>
                </div>
                <div>
                    <span>Psychic</span>
                    <input type="number" readonly="true" value="0" name="attr_psychic"/>
                </div>
                <div>
                    <span>Sonic</span>
                    <input type="number" readonly="true" value="0" name="attr_sonic"/>
                </div>
            </div>
        </div>
        
        <!-- Armor -->
        <div class="container-style main-width">
            <div style="text-align: center;">
                <span class="header">ARMOR</span>
            </div>

            <div class="hr"></div>
            <div style="text-align: center;">
                <span class="text-color">ARMOR LOADOUT 1</span>
            </div>
            <div style="text-align: center;">
                <span>Active?</span>
                <input type="checkbox" name="attr_armor_active_1">
            </div>

            <div class="row">
                <div>
                    <span>Acid</span>
                    <input type="number" value="0" name="attr_acid_armor_1"/>
                </div>
                <div>
                    <span>Cold</span>
                    <input type="number" value="0" name="attr_cold_armor_1"/>
                </div>
                <div>
                    <span>Death</span>
                    <input type="number" value="0" name="attr_death_armor_1"/>
                </div>
                <div>
                    <span>Electric</span>
                    <input type="number" value="0" name="attr_electric_armor_1"/>
                </div>
                <div>
                    <span>Fire</span>
                    <input type="number" value="0" name="attr_fire_armor_1"/>
                </div>
            </div>
            <div class="row">
                <div>
                    <span>Light</span>
                    <input type="number" value="0" name="attr_light_armor_1"/>
                </div>
                <div>
                    <span>Physical</span>
                    <input type="number" value="0" name="attr_physical_armor_1"/>
                </div>
                <div>
                    <span>Poison</span>
                    <input type="number" value="0" name="attr_poison_armor_1"/>
                </div>
                <div>
                    <span>Psychic</span>
                    <input type="number" value="0" name="attr_psychic_armor_1"/>
                </div>
                <div>
                    <span>Sonic</span>
                    <input type="number" value="0" name="attr_sonic_armor_1"/>
                </div>
            </div>

            <div class="hr"></div>
            <div style="text-align: center;">
                <span class="text-color">ARMOR LOADOUT 2</span>
            </div>
            <div style="text-align: center;">
                <span>Active?</span>
                <input type="checkbox" name="attr_armor_active_2">
            </div>

            <div class="row">
                <div>
                    <span>Acid</span>
                    <input type="number" value="0" name="attr_acid_armor_2"/>
                </div>
                <div>
                    <span>Cold</span>
                    <input type="number" value="0" name="attr_cold_armor_2"/>
                </div>
                <div>
                    <span>Death</span>
                    <input type="number" value="0" name="attr_death_armor_2"/>
                </div>
                <div>
                    <span>Electric</span>
                    <input type="number" value="0" name="attr_electric_armor_2"/>
                </div>
                <div>
                    <span>Fire</span>
                    <input type="number" value="0" name="attr_fire_armor_2"/>
                </div>
            </div>
            <div class="row">
                <div>
                    <span>Light</span>
                    <input type="number" value="0" name="attr_light_armor_2"/>
                </div>
                <div>
                    <span>Physical</span>
                    <input type="number" value="0" name="attr_physical_armor_2"/>
                </div>
                <div>
                    <span>Poison</span>
                    <input type="number" value="0" name="attr_poison_armor_2"/>
                </div>
                <div>
                    <span>Psychic</span>
                    <input type="number" value="0" name="attr_psychic_armor_2"/>
                </div>
                <div>
                    <span>Sonic</span>
                    <input type="number" value="0" name="attr_sonic_armor_2"/>
                </div>
            </div>

            <div class="hr"></div>
            <div style="text-align: center;">
                <span class="text-color">ARMOR LOADOUT 3</span>
            </div>
            <div style="text-align: center;">
                <span>Active?</span>
                <input type="checkbox" name="attr_armor_active_3">
            </div>

            <div class="row">
                <div>
                    <span>Acid</span>
                    <input type="number" value="0" name="attr_acid_armor_3"/>
                </div>
                <div>
                    <span>Cold</span>
                    <input type="number" value="0" name="attr_cold_armor_3"/>
                </div>
                <div>
                    <span>Death</span>
                    <input type="number" value="0" name="attr_death_armor_3"/>
                </div>
                <div>
                    <span>Electric</span>
                    <input type="number" value="0" name="attr_electric_armor_3"/>
                </div>
                <div>
                    <span>Fire</span>
                    <input type="number" value="0" name="attr_fire_armor_3"/>
                </div>
            </div>
            <div class="row">
                <div>
                    <span>Light</span>
                    <input type="number" value="0" name="attr_light_armor_3"/>
                </div>
                <div>
                    <span>Physical</span>
                    <input type="number" value="0" name="attr_physical_armor_3"/>
                </div>
                <div>
                    <span>Poison</span>
                    <input type="number" value="0" name="attr_poison_armor_3"/>
                </div>
                <div>
                    <span>Psychic</span>
                    <input type="number" value="0" name="attr_psychic_armor_3"/>
                </div>
                <div>
                    <span>Sonic</span>
                    <input type="number" value="0" name="attr_sonic_armor_3"/>
                </div>
            </div>
        </div>
        
        <!-- Shield -->
        <div class="container-style main-width">
            <div style="text-align: center;">
                <span class="header">SHIELD</span>
            </div>

            <div style="text-align: center;">
                <span>Active?</span>
                <input type="checkbox" name="attr_shield_active">
            </div>

            <div class="row">
                <div>
                    <span>Melee</span>
                    <input type="number" value="0" name="attr_melee_defense_shield"/>
                </div>
                <div>
                    <span>Ranged</span>
                    <input type="number" value="0" name="attr_ranged_defense_shield"/>
                </div>
                <!--<div>
                    <span>Thrown</span>
                    <input type="number" value="0" name="attr_thrown_defense_shield"/>
                </div>
                <div>
                    <span>Unarmed</span>
                    <input type="number" value="0" name="attr_unarmed_defense_shield"/>
                </div>-->
                <div>
                    <span>Spellstrike</span>
                    <input type="number" value="0" name="attr_spell_defense_shield"/>
                </div>
            </div>

            <div class="row">
                <div>
                    <span>Effect</span>
                    <input type="number" value="0" name="attr_effect_defense_shield"/>
                </div>
                <div>
                    <span>Ability</span>
                    <input type="number" value="0" name="attr_ability_defense_shield"/>
                </div>
                <!--<div>
                    <span>Rune</span>
                    <input type="number" value="0" name="attr_rune_defense_shield"/>
                </div>-->
                <div>
                    <span>Environment</span>
                    <input type="number" value="0" name="attr_environment_defense_shield"/>
                </div>
            </div>
        </div>
    


        <div class="container-style main-width">
            <fieldset class="repeating_equipment">
                <div class="equipment-header">
                    <button type="action" name="act_equip_collapse" title="Show/Hide Details"></button>
    
                    <input type="text" name="attr_equipment_amount" title="Amount" />
    
                    <input type="text" name="attr_equipment_name" title="Name" />
    
                    <input type="text" name="attr_equipment_value" title="Value" />
    
                    <input type="text" name="attr_equipment_weight" title="Weight" />
                </div>
    
                <input class="equipment-collapse" type="hidden" name="attr_equipment_collapse" value="1" />
                <div class="collapse-description">
                    <textarea class="main-width" name="attr_ability_text" title="Ability Description"></textarea>
                </div>
            </fieldset>
        </div>
    </div> <!-- end: #page-equipment -->
    
    
    
    
    
    <!-------------------->
    <!-- PAGE: ROLEPLAY -->
    <!-------------------->
    <div id="page_roleplay" class="hidden">
        <div style="width:45%;text-align:center;display:inline-block;margin-left:3%;vertical-align: top;">
            <div class="stylized-type" style="width:100%; padding-bottom: 10px; margin-bottom:6px; visibility:hidden;">
                <span style="margin:0px; margin-bottom:3px;">Consider this an easter egg</span>
                <input type="number" style="float:right;"/>
            </div>
            <span>Goals</span>
            <br>
            <textarea style="width:100%;" rows="4" name="attr_roleplay_goals"></textarea>
            <span>Bonds</span>
            <br>
            <textarea style="width:100%;" rows="13" name="attr_roleplay_bonds"></textarea>
            <span>Flaws</span>
            <br>
            <textarea style="width:100%;" rows="13" name="attr_roleplay_flaws"></textarea>
        </div>
        
        <div style="width:45%;text-align:center;display:inline-block;margin-left:2%;vertical-align: top;">
            <div class="stylized-type" style="width:100%; padding-bottom: 10px; margin-bottom:6px;">
                <span style="margin:0px; margin-bottom:3px;">Current Fated Struggle Value</span>
                <input type="number" name="attr_struggle" style="float:right;"/>
            </div>
            <span>Struggles</span>
            <br>
            <textarea style="width:100%;" rows="18" name="attr_roleplay_struggles"></textarea>
            <span>Triggers</span>
            <br>
            <textarea style="width:100%;" rows="18" name="attr_roleplay_triggers"></textarea>
            <span>Languages</span>
            <br>
            <textarea style="width:100%; height: fit-content;" readonly="true" name="attr_languages">Evritung</textarea>
        </div>
    </div> <!-- end: #page-roleplay -->
    
    
    
    
    
    <!---------------------->
    <!-- PAGE: CHEATSHEET -->
    <!---------------------->
    <div id="page_cheatsheet" class="hidden">
        <h1 style="color: inherit">TECHNIQUES</h1> <!--TPTODO-->
    
        <div class="cheatsheet-header">
            <div class="container-style" style="padding: 5px; margin-bottom:6px;">
                <p>Simple techniques cost a tactical action. Advanced techniques cost a tactical action and 5 MP.</p>
            </div>
            
            <div class="container-style" style="margin-top: 6px;  margin-bottom:6px;">
                <h3 style="color: inherit">SIMPLE:</h3>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Cleanse</h3>
                <p>Make an offensive effect roll vs the defense effect roll of the target that applied or is applying the status effect. On a success, you remove the status effect.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Disengage</h3>
                <p>All creatures cannot take opportunity actions against you until your actions reset as a result of you moving out of adjacency with them.</p>
            </div>

            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Dodge</h3>
                <p>You can tumble 2 Tiles in a direction of your choice. This does not affect your base movement speed and you can still be affected by opportunity actions.</p>
            </div>

            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Hide</h3>
                <p>The hide technique will allow you to prevent creatures from noticing you. When outside of combat, attempting to hide from a creature will provoke a stealth trait roll versus their detection trait roll to determine if they notice you. While inside combat, hiding will allow you to enter “stealth mode.” While in stealth mode, you have +2 ADV to all defense rolls. However, other creatures still have a general idea of where you are, and can use AoE abilities centered on your location. You will lose stealth mode if you take any action (including defense actions), use any movement, make a defense roll, or if a creature uses the search technique on you.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Plummet</h3>
                <p>Select one target you can see or can hear you. You can cause a chosen effect such as screaming at them, a commanding stare, magical vines, next attack, etc. to knock a creature out of the air. The target makes a defense effect roll vs your offensive effect roll. The target gains +1 ADV based on its size ADV. On a fail, the target immediately stops flying/ hovering and falls to the ground (taking any fall damage).</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Object</h3>
                <p>You can interact with one object or equipment in the following ways: swapping something on your person, storing, drawing, donning, removing, dropping, reloading, throwing it non-harmfully up to 5 Tiles away, catching, passing it to another creature, ingest one thing, using it, or apply a weapon ability.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Search</h3>
                <p>You and allies of your choice that can see the selected target or hear you learn the general location of a hidden target you are capable of seeing or within line of sight.</p>
            </div>

            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Shove</h3>
                <p>One target within your reach must make a defense effect roll vs your offensive effect roll. A creature has +1 ADV to this roll based on their size ADV. On a fail, the target is pushed horizontally in a direction of your choice up to 2 Tiles + 1 Tile per your size ADV. If you are wielding a shield you can attempt to push all targets of your choice adjacent to the original target.</p>
            </div>

            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Target</h3>
                <p>Select a specific place, object, equipment, etc. to affect or disarm. Any rolls of your choice that you make until your actions reset to target the selected thing has +1 DisADV to do so. A creature has +1 ADV to this roll if they are holding it in two hands or more. On a success, you are able to target what you intended to and the FD may apply additional fair effects for what was targeted. For example you can disarm a target's weapon, dropping it on any tile of your choice occupied by the disarmed creature, or shoot an arrow into a target's eye, potentially giving them the blinded status effect, etc.</p>
            </div>

            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Trip</h3>
                <p>Select one target within your reach. That target must make a defense effect roll vs your offense effect roll, and a creature gains +1 ADV based on their size ADV. On a failure, the target is forced prone.</p>
            </div>
            
            <div class="container-style" style="margin-top: 6px; margin-bottom:6px;">
                <h3 style="color: inherit">ADVANCED:</h3>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Aggro</h3>
                <p>One target of your choice that can see or hear you must make a defense effect roll vs your offensive effect roll. A creature gains +1 ADV based on their size ADV. On a failure, they gain the aggroed status effect.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Block</h3>
                <p>The next defense roll of your choice that you make in the next minute gains +1 ADV.</p>
            </div>

            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Charging</h3>
                <p>You can move through enemy spaces without it being difficult terrain. You still are affected by opportunity actions from this movement. Additionally, once per creature you move through can make a defense effect roll vs your offense effect roll. A creature gets +1 ADV to this roll based on their size ADV. On a fail the target takes true damage equal to ½ your total level.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Help</h3>
                <p>When a target within your reach makes a 2d10 roll, before the roll is made you can give them +1 ADV on that roll. Creatures cannot benefit from more than one help technique on a single roll.</p>
            </div>

            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Intimidate</h3>
                <p>One target of your choice that can see or hear you must make a defense effect roll vs your offensive effect roll. A creature gains +1 ADV based on their size ADV. On a fail, they gain the frightened status effect.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Purify</h3>
                <p>You automatically remove one status effect of your choice that can be removed.</p>
            </div>

            <div class="container-style" style="margin-top: 6px; margin-bottom:6px;">
                <h3 style="color: inherit">SPECIAL:</h3>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Parry</h3>
                <p>When you succeed on a defense roll against an attack you can make an attack back at them if able. If you are dual-wielding you can make a number of attacks based on the number of actions spent to parry. Additionally, each brutal defense will decrease the action cost by 1. For 1 brutal defense a main action & 2 tactical actions is reduced to 1 tactical action. For 2+ brutal defenses they parry is a free action.</p>
            </div>
        </div>
        
        <div style="height: 30px"></div> <!--TPTODO-->
        <h1 style="color: inherit">GRAPPLING</h1>

        <div class="container-style" style="padding: 5px; margin-bottom:6px;">
            <p>Grappling is a combat technique that involves grabbing, holding, or restraining an opponent in close-quarters physical engagement. It is used to control an enemy's movement, limit their actions, or set up for subsequent attacks or maneuvers. Grappling can involve various techniques such as slamming, throws, pins, etc. It requires strategic positioning to gain an advantage over the opponent. Successful grappling can provide opportunities for controlling the battlefield and neutralizing threats.</p>
        </div>
    
        <div class="cheatsheet-header">
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Grapple Check</h3>
                <p>As a main action, you can attempt to grapple a target with a free hand within your reach. You must make an offense effect roll vs the target's defense effect roll, a creature gains +1 ADV based on their size ADV. If you win you successfully grapple them. The creature doing the grappling is known as the grappler, and the target being grappled is known as the grappled target. Any forced movement will cause any creature that wants to hold on to make a defense roll of the same type as the offense roll that forced the movement, and if they succeed this roll, they can choose to either move with the target or stop the forced movement entirely.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Moving While Grappling</h3>
                <p>Unless otherwise stated, both creatures can still move each other whenever they would move. However, the grappler and grappled target have all movement speeds halved. When either target attempts to move or dash they both must remake the grapple check and if the target initiating the move wins, they can successfully move with the other target.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Escaping A Grapple</h3>
                <p>While grappled the grappled target can spend a tactical action to attempt to escape the grapple by remaking the grapple check vs the grappler. On a success the grappled target breaks free of the grapple. The grappler can willingly let go or stop grappling as a free action.</p>
            </div>
            
            <div class="container-style" style="padding-bottom: 10px; margin-bottom:6px;">
                <h3 style="color: inherit">Grappling Techniques</h3>
                <p>Grappling techniques are different maneuvers and techniques used while grappling to try and gain an advantage in combat. Whenever you use a grappling technique you must remake the contested grapple check to determine whether or not the grappling technique works. If you succeed the grappling technique takes effect. If they succeed the grappling technique does not occur but they remain grappled.</p>
                <ul>
                    <li><b>Body Block:</b> When you are targeted by an attack or effect that deals damage you can spend 1 main action to attempt to reposition the grappled target between you and the damage source. If successful, the grappled target takes half of the damage and you take the remainder.</li>
                    <li><b>Pin:</b> As a main action you can attempt to pin a grappled target into the ground or solid object such as a wall. If you succeed, the grappled target's speed is reduced to 0, all attacks against the grappled target have +1 ADV and the grappled target has +1 DisADV on attacks it makes. The grappled target can spend 1 main action to automatically escape the pin.</li>
                    <li><b>Slam:</b> As a main action you can attempt to slam a grappled target into something. If you succeed the grappled target takes true damage equal to your 2 + total level. If the grappled target is slammed into another creature the grappled target takes half the damage, and the other creature takes the remaining damage (minimum of 1).</li>
                    <li><b>Takedown:</b> As a main action you can attempt to take down or sweep a grappled target. If you succeed, the grappled target falls prone.</li>
                    <li><b>Throw:</b> As a main action you can attempt to throw a grappled target up to 5 tiles away +1 tile for each size category you are above the grappled target. If you succeed the target takes 1 true damage for every 2 tiles it traveled before colliding with something. If the grappled target is thrown into another creature the grappled target takes half the damage, and the other creature takes the remaining damage. You can also choose to throw the grappled target upwards and they become susceptible to fall damage.</li>
                </ul>
            </div>
        </div>
    </div> <!-- end: #page-cheatsheet -->
    
    
    
    
    </div>
    
    
    
    
    
    <!-- Displays roll results in Roll20's chat, ID is "r_template" -->
    <!-- Hidden on the character sheet inside Roll20, but displays incorrectly if this file is loaded as pure .html -->
    <rolltemplate class="sheet-rolltemplate-r_template">
        <!-- At the time of this writing, Roll20's StartRoll() function is incapable of
        creating GM-only rolls (i.e. rolls that only the GM can see).
        
        The following is a nasty workaround to hide rolls from clients. In essence, if the "hide-rolls"
        button is checked, the roll template will output a roll with its important info set to 'display:none;'. 
        In order for the GM to see the roll, they need to set up a third-party browser extension
        (such as Stylus) with the following snippet of CSS:
        .sheet-template-container { display:block !important; }
    
        These rolls are therefore entirely secured through obscurity, much to my displeasure. -->
    
        {{#rollTotal() hidden_roll 0}}
        <div class="sheet-template-container" style="border-style:groove; padding:5px;">
            {{#rollTotal() mods_applied 1}}
            <span style="font-size: 12px; opacity: 50%; position: relative; bottom: 6px; left: 10px;">GLOBAL MODIFIERS HAVE BEEN APPLIED</span>
            {{/rollTotal() mods_applied 1}}
    
            <div>
                <!-- If crit success, show crit roll value in green -->
                {{#rollGreater() computed::roll roll}}
                <span style="font-size: 14px; color: #00D300;">{{computed::roll}}</span>
                {{/rollGreater() computed::roll roll}}
    
                <!-- If fumble, show fumble roll value in red -->
                {{#rollLess() computed::roll roll}}
                <span style="font-size: 14px; color: red;">{{computed::roll}}</span>
                {{/rollLess() computed::roll roll}}
    
                <!-- Otherwise, show default roll value -->
                {{#rollTotal() computed::roll roll}}
                <span style="font-size: 14px;">{{computed::roll}}</span>
                {{/rollTotal() computed::roll roll}}
                <span style="display: inline; overflow: hidden; text-overflow: ellipsis; margin-left: 2px; font-size: 16px; font-weight: bold;">{{roll_name}}{{#rollTotal() is_attack 1}} [{{damage_type}}]{{/rollTotal() is_attack 1}}</span>
            </div>
            {{#rollTotal() is_attack 1}}
            <div style="width: 75%; margin-top: 6px;">
                <span style="font-size: 16px; display: block; margin-bottom: 3px;"><b>{{damage}}</b> damage</span>
                <span style="font-size: 15px; display: block; margin-bottom: 3px;"><b>{{brutal_damage}}</b> brutal damage</span>
                <span style="font-size: 15px; display: block; margin-bottom: 3px;"><b>{{attack_type}}</b> attack</span>
            </div>
            {{/rollTotal() is_attack 1}}
            <div style="text-align: right;">
                <span style="width: 40%; margin-top: 6px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 13px;">{{character_name}}</span>
            </div>
        </div>
        {{/rollTotal() hidden_roll 0}}
    
        {{#rollTotal() hidden_roll 1}}
        <div style="border-style:groove; padding:5px;">
            <span style="font-size: 12px; opacity: 50%; left: 10px;">FD-ONLY ROLL</span>
            <div class="sheet-template-container" style="display: none; position: relative; top: 6px; padding-bottom: 6px;">
                {{#rollTotal() mods_applied 1}}
                <span style="font-size: 12px; opacity: 50%; position: relative; bottom: 6px; left: 10px;">GLOBAL MODIFIERS HAVE BEEN APPLIED</span>
                {{/rollTotal() mods_applied 1}}
        
                <div>
                    <!-- If crit success, show crit roll value in green -->
                    {{#rollGreater() computed::roll roll}}
                    <span style="font-size: 14px; color: #00D300;">{{computed::roll}}</span>
                    {{/rollGreater() computed::roll roll}}
        
                    <!-- If fumble, show fumble roll value in red -->
                    {{#rollLess() computed::roll roll}}
                    <span style="font-size: 14px; color: red;">{{computed::roll}}</span>
                    {{/rollLess() computed::roll roll}}
        
                    <!-- Otherwise, show default roll value -->
                    {{#rollTotal() computed::roll roll}}
                    <span style="font-size: 14px;">{{computed::roll}}</span>
                    {{/rollTotal() computed::roll roll}}
                    <span style="display: inline; overflow: hidden; text-overflow: ellipsis; margin-left: 2px; font-size: 16px; font-weight: bold;">{{roll_name}}{{#rollTotal() is_attack 1}} [{{damage_type}}]{{/rollTotal() is_attack 1}}</span>
                </div>
                {{#rollTotal() is_attack 1}}
                <div style="width: 75%; margin-top: 6px;">
                    <span style="font-size: 16px; display: block; margin-bottom: 3px;"><b>{{damage}}</b> damage</span>
                    <span style="font-size: 15px; display: block; margin-bottom: 3px;"><b>{{brutal_damage}}</b> brutal damage</span>
                    <span style="font-size: 15px; display: block; margin-bottom: 3px;"><b>{{attack_type}}</b> attack</span>
                </div>
                {{/rollTotal() is_attack 1}}
                <div style="text-align: right;">
                    <span style="width: 40%; margin-top: 6px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; font-size: 13px;">{{character_name}}</span>
                </div>
            </div>
        </div>
        {{/rollTotal() hidden_roll 1}}
    </rolltemplate>
    
    
    
    
    
    <!------------>
    <!-- SCRIPT -->
    <!------------>
    <script type="text/worker">
        const traitlist = ["agility", "apothecary", "bargain", "communication", "convince", "detection", "engineering", "entertainment", "etiquette", "hands", "history", "intuition", "magic", "might", "navigation", "perseverance", "profession", "religion", "soothe", "stealth", "threat", "wilderness"];
        const attacklist = ["melee", "ranged", "thrown", "unarmed", "spell", "effect", "ability", "rune", "environment"];
        const defenselist = ["melee_defense", "ranged_defense", "thrown_defense", "unarmed_defense", "spell_defense", "effect_defense", "ability_defense", "rune_defense", "environment_defense"];
        const tolerancelist = ["acid", "cold", "death", "electric", "fire", "light", "physical", "poison", "psychic", "sonic"];
        




        /*****************************/
        /* Utility & misc. functions */
        /*****************************/
    
        //Function to make a dice roll
        const _makeRoll = (data) => {
            let rollText;
            if(data.advantage >= 0){
                //If player has advantage, take highest
                rollText = `[[2 + ${data.advantage}]]d10kh2cs>21cf<0 + ${data.bonus}`;
            } else {
                //If player has disadvantage, take lowest
                rollText = `[[2 + ${data.advantage} * -1]]d10kl2cs>21cf<0 + ${data.bonus}`;
            }
    
            const isAttack = (data.is_attack ? 1 : 0);
            const critMin = (data.crit_min ? data.crit_min : 20);
            const hiddenRoll = (data.hidden_roll == "on" ? 1 : 0);
    
            let startRollInput = `&{template:r_template}`
            startRollInput += `{{roll=[[${rollText}]]}}`
            startRollInput += `{{hidden_roll=[[${hiddenRoll}d1]]}}`
            
            startRollInput += `{{roll_name=${data.roll_name}}}`
            startRollInput += `{{character_name=${data.character_name}}}`

            startRollInput += `{{is_attack=[[${isAttack}d1]]}}`
            startRollInput += `{{damage_type=${data.damage_type}}}`
            startRollInput += `{{damage=${data.damage}}}`
            startRollInput += `{{brutal_damage=${data.brutal_damage}}}`
            startRollInput += `{{attack_type=${data.attack_type}}}`

            startRoll(startRollInput, (results) => {
                let original = results.results.roll.result;
                let computed = original - data.bonus;
                
                //Determines if the number is a crit
                //"computed" cannot be directly compared to an integer using "==", so comparisons are instead made using ">"
                if(computed > critMin - 1){ //This is a crit
                    computed  = original + 10;
                } else if(computed < 3) { //This is a critfail
                    computed = 0;
                } else {
                    computed = original;
                }
    
                finishRoll(
                    results.rollId,
                    {
                        roll: computed
                    }
                );
            });
        }

        const capitalizeFirstLetter = function (input) {
            //TPTODO:
            console.log(input);
            if(input == "melee_defense"){
                return "Melee Defense";
            } else if(input == "ranged_defense"){
                return "Ranged Defense";
            } else if(input == "spell_defense"){
                return "Spellstrike Defense";
            } else if(input == "effect_defense"){
                return "Effect Defense";
            } else if(input == "ability_defense"){
                return "Ability Defense";
            } else if(input == "environment_defense"){
                return "Environment Defense";
            }
            
            if(input.length >= 2){
                return input.charAt(0).toUpperCase() + input.slice(1);
            } else {
                return input.toUpperCase();
            }
        }

        const LEcalc = function (level, LE) {
            if(LE == 0){
                return 0;
            } else {
                console.log(Math.ceil(parseInt(level || 1)/2));
                return LE - 1 + Math.ceil(parseInt(level || 1)/2);
            }
        }
    


        // Switches pages
        const pagelist = ["main","equipment","level","cheatsheet","roleplay"];
        pagelist.forEach(pagebutton => {
            on(`clicked:${pagebutton}`, function() {
                pagelist.forEach(page => $20(`#page_${page}`).addClass("hidden"));
                $20("#page_" + pagebutton).removeClass("hidden");
            });
        });

        // Handles sheet color
        on("change:settings_color sheet:opened", function(eventInfo) {
            getAttrs(["settings_color"], function(data) {
                if(eventInfo.previousValue){
                    $20("#full_sheet").removeClass(eventInfo.previousValue.toLowerCase());
                }
                $20("#full_sheet").addClass(data.settings_color.toLowerCase());
            });
        });

        // Handles trait direction
        on("change:settings_traitdirection sheet:opened", function(eventInfo) {
            getAttrs(["settings_traitdirection"], function(data) {
                if(data.settings_traitdirection === "Horizontal"){
                    $20(".horizontal-traits").removeClass("hidden");
                    $20(".vertical-traits").addClass("hidden");
                } else {
                    $20(".horizontal-traits").addClass("hidden");
                    $20(".vertical-traits").removeClass("hidden");
                }
            });
        });

        // Handles sheet collapses
        const collapselist = ["character","traits","stats","dcdefense"];
        collapselist.forEach(collapse => {
            on(`clicked:${collapse}_collapse sheet:opened`, function(e) {
                getAttrs([`${collapse}_collapse`], function(data) {
                    let val = (parseInt(data[`${collapse}_collapse`]) == 1 ? 0 : 1);
                    if(e.triggerName === "sheet:opened"){
                        val = (val == 1 ? 0 : 1);
                    }
                    if(val){
                        $20(`#${collapse}_collapse`).addClass("collapsed");
                    } else {
                        $20(`#${collapse}_collapse`).removeClass("collapsed");
                    }
                    setAttrs({
                        [`${collapse}_collapse`]: val
                    });
                });
            });
        });



        on(`change:character_level sheet:opened`, function() {
            getAttrs(["character_level"], function(data) {
                setAttrs({
                    rest_max: Math.ceil(parseInt(data.character_level || 1)/3)
                });
            });
        });
        
        on(`change:equipslots_lu change:character_level sheet:opened`, function() {
            getAttrs(["equipslots_lu", "character_level"], function(data) {
                setAttrs({
                    equipslots_max: LEcalc(data.character_level, data.equipslots_lu) + 5
                });
            });
        });


    


        /*************/
        /* Abilities */
        /*************/

        on('clicked:repeating_abilities:load', function() {
            getAttrs(["repeating_abilities_ability_load"], function(data) {
                let val = (parseInt(data.repeating_abilities_ability_load) === 1);
                setAttrs({
                    repeating_abilities_ability_load: (val ? 0 : 1)
                });
            })
        });

        on('clicked:repeating_abilities:collapse', function() {
            getAttrs(["repeating_abilities_ability_collapse"], function(data) {
                setAttrs({
                    repeating_abilities_ability_collapse: (parseInt(data.repeating_abilities_ability_collapse) === 1 ? 0 : 1)
                });
            });
        });
        
        on('clicked:repeating_abilities:layout', function() {
            getAttrs(["repeating_abilities_ability_layout"], function(data) {
                let result = parseInt(data.repeating_abilities_ability_layout) + 1;
                result = (result > 2 ? 1 : result);
                setAttrs({
                    repeating_abilities_ability_collapse: 0, //open
                    repeating_abilities_ability_layout: result
                });
            })
        });

        // Handles sheet color
        on("change:repeating_abilities:color", function(eventInfo) {
            getAttrs(["repeating_abilities_color"], function(data) {
                setAttrs({
                    repeating_abilities_ability_color: data.repeating_abilities_color
                });
            });
        });




        on("change:repeating_abilities:category", function(eventInfo) {
            getAttrs(["repeating_abilities_category"], function(data) {
                console.log(data.repeating_abilities_category);
                setAttrs({
                    repeating_abilities_ability_category: data.repeating_abilities_category
                });
            });
        });

        on("change:outside_category", function(eventInfo) {
            getAttrs(["outside_category"], function(data) {
                console.log(data.outside_category);
                setAttrs({
                    outside_ability_category: data.outside_category
                });
            });
        });
    
    
    
        //Handles button presses
        traitlist.forEach(trait => {
            on(`clicked:${trait}`, function() {
                getAttrs(["hidden_roll", "character_name", `${trait}`, `${trait}_advantage`, "advantage", "modifier", "trait_advantage", "trait_modifier", "trait_minimum"], function(data) {
                    let rollData = {
                        "bonus": parseInt(data[`${trait}`]) + parseInt(data.modifier) + parseInt(data.trait_modifier),
                        "advantage": parseInt(data.advantage) + parseInt(data.trait_advantage) + parseInt(data[`${trait}_advantage`]),
                        "crit_min": parseInt(data.trait_minimum),
                        "character_name": data.character_name,
                        "roll_name": capitalizeFirstLetter(trait),
                        "mods_applied": (data.advantage != 0 || data.modifier != 0 || data.minimum != 0),
                        "hidden_roll": data.hidden_roll,
                    }
                    _makeRoll(rollData);
                })
            });
            on(`change:${trait}_lu change:character_level sheet:open`, function() {
                getAttrs([`${trait}_lu`, "character_level"], function(data) {
                    setAttrs({
                        [`${trait}`]: LEcalc(data.character_level, parseInt(data[`${trait}_lu`]))
                    });
                });
            });
        });
    
        defenselist.forEach(defense => {
            on(`clicked:${defense}`, function() {
                getAttrs(["hidden_roll", "character_name", `${defense}`, "advantage", "modifier", "defense_advantage", "defense_modifier", "defense_minimum"], function(data) {
                    let rollData = {
                        "bonus": parseInt(data[`${defense}`]) + parseInt(data.modifier) + parseInt(data.defense_modifier),
                        "advantage": parseInt(data.advantage) + parseInt(data.defense_advantage),
                        "crit_min": parseInt(data.defense_minimum),
                        "character_name": data.character_name,
                        "roll_name": capitalizeFirstLetter(defense),
                        "mods_applied": (data.advantage != 0 || data.modifier != 0 || data.minimum != 0),
                        "hidden_roll": data.hidden_roll,
                    }
                    console.log(rollData); //TPTODO
                    _makeRoll(rollData);
                })
            });
            on(`change:${defense}_lu change:${defense}_shield change:shield_active change:character_level sheet:open`, function() {
                getAttrs([`${defense}_lu`, `${defense}_shield`, "character_level", "shield_active"], function(data) {
                    setAttrs({
                        [`${defense}`]: (data.shield_active == "on") * parseInt(data[`${defense}_shield`]) + LEcalc(data.character_level, parseInt(data[`${defense}_lu`]))
                    });
                });
            });
        });
    
    
        console.log("tolerances");
    
        
        tolerancelist.forEach(tolerance => {
            on(`change:${tolerance}_lu change:${tolerance}_armor_1 change:${tolerance}_armor_2 change:${tolerance}_armor_3 change:character_level sheet:opened`, function() {
                updateTolerance(tolerance);
            });
        });
        on("change:armor_active_1 change:armor_active_2 change:armor_active_3 change:character_level sheet:opened", function() {
            tolerancelist.forEach(tolerance => {
                updateTolerance(tolerance);
            });
        });
        const updateTolerance = (tolerance) => {
            getAttrs(["character_level", `${tolerance}_lu`, `${tolerance}_armor_1`, `${tolerance}_armor_2`, `${tolerance}_armor_3`, "armor_active_1", "armor_active_2", "armor_active_3"], function(data) {
                let val = LEcalc(data.character_level, parseInt(data[`${tolerance}_lu`] || 0)) + (data["armor_active_1"] == "on") * parseInt(data[`${tolerance}_armor_1`] || 0) + (data["armor_active_2"] == "on") * parseInt(data[`${tolerance}_armor_2`] || 0) + (data["armor_active_3"] == "on") * parseInt(data[`${tolerance}_armor_3`] || 0);
                setAttrs({
                    [`${tolerance}`]: val
                });
            });
        }
    
    
    
    
        traitlist.forEach(trait => {
            on(`change:${trait}_advantage sheet:opened`, function() {
                getAttrs([`${trait}_advantage`], function(values) {
                    if(parseInt(values[`${trait}_advantage`]) == 1){
                        $20(`.${trait}`).addClass("advantaged-trait");
                        $20(`.${trait}`).removeClass("disadvantaged-trait");
                    }
                    else if(parseInt(values[`${trait}_advantage`]) == -1){
                        $20(`.${trait}`).removeClass("advantaged-trait");
                        $20(`.${trait}`).addClass("disadvantaged-trait");
                    } else {
                        $20(`.${trait}`).removeClass("advantaged-trait");
                        $20(`.${trait}`).removeClass("disadvantaged-trait");
                    }
                });
            });
        });
    
    
    
        attacklist.forEach(attack => {
            on(`change:${attack}_lu change:character_level sheet:opened`, function() {
                getAttrs(["character_level", `${attack}_lu`], function(data) {
                    setAttrs({
                        [`${attack}`]: LEcalc(data.character_level, parseInt(data[`${attack}_lu`])) + 3
                    });
                });
            });
        });
    
    
    
        
    

    
        on('clicked:repeating_abilities:melee', function() {
            getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_global_damage", "ability_global_critmin", "melee", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_melee_range", "repeating_abilities_ability_damage_type"], function(data) {
                
                console.log(parseInt(data.melee));
                console.log(LEcalc(data.character_level, parseInt(data.melee)));
                console.log(parseInt(data.modifier));
                console.log(parseInt(data.ability_accuracy));

                let rollData = {
                    "bonus": parseInt(data.melee) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
                    "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
                    "character_name": data.character_name,
                    "roll_name": data.repeating_abilities_ability_name,
                    "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
                    "brutal_damage": data.repeating_abilities_ability_brutal,
                    "range": data.repeating_abilities_ability_melee_range,
                    "crit_min": data.ability_global_critmin,
                    "damage_type": data.repeating_abilities_ability_damage_type,
                    "is_attack": true,
                    "hidden_roll": data.hidden_roll,
                    "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
                    "attack_type": "Melee",
                }
                console.log(rollData); //TPTODO
                _makeRoll(rollData);
            })
        });
    
        on('clicked:repeating_abilities:ranged', function() {
            getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_global_damage", "ability_global_critmin", "ranged", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_ranged_range", "repeating_abilities_ability_damage_type"], function(data) {
                
                let rollData = {
                    "bonus": parseInt(data.ranged) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
                    "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
                    "character_name": data.character_name,
                    "roll_name": data.repeating_abilities_ability_name,
                    "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
                    "brutal_damage": data.repeating_abilities_ability_brutal,
                    "range": data.repeating_abilities_ability_ranged_range,
                    "crit_min": data.ability_global_critmin,
                    "damage_type": data.repeating_abilities_ability_damage_type,
                    "is_attack": true,
                    "hidden_roll": data.hidden_roll,
                    "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
                    "attack_type": "Ranged",
                }
                console.log(rollData); //TPTODO
                _makeRoll(rollData);
            })
        });
    
        on('clicked:repeating_abilities:thrown', function() {
            getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_global_damage", "ability_global_critmin", "thrown", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_thrown_range", "repeating_abilities_ability_damage_type"], function(data) {
                
                let rollData = {
                    "bonus": parseInt(data.thrown) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
                    "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
                    "character_name": data.character_name,
                    "roll_name": data.repeating_abilities_ability_name,
                    "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
                    "brutal_damage": data.repeating_abilities_ability_brutal,
                    "range": data.repeating_abilities_ability_thrown_range,
                    "crit_min": data.ability_global_critmin,
                    "damage_type": data.repeating_abilities_ability_damage_type,
                    "is_attack": true,
                    "hidden_roll": data.hidden_roll,
                    "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
                    "attack_type": "Thrown",
                }
                console.log(rollData); //TPTODO
                _makeRoll(rollData);
            })
        });
    
        on('clicked:repeating_abilities:spell', function() {
            getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_minimum", "ability_global_damage", "ability_global_critmin", "spell", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_spell_range", "repeating_abilities_ability_damage_type"], function(data) {
                
                let rollData = {
                    "bonus": parseInt(data.spell) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
                    "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
                    "character_name": data.character_name,
                    "roll_name": data.repeating_abilities_ability_name,
                    "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
                    "brutal_damage": data.repeating_abilities_ability_brutal,
                    "range": data.repeating_abilities_ability_spell_range,
                    "crit_min": data.ability_global_critmin,
                    "damage_type": data.repeating_abilities_ability_damage_type,
                    "is_attack": true,
                    "hidden_roll": data.hidden_roll,
                    "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
                    "attack_type": "Spellstrike",
                }
                console.log(rollData); //TPTODO
                _makeRoll(rollData);
            })
        });

        on('clicked:repeating_abilities:unarmed', function() {
            getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_minimum", "ability_global_damage", "ability_global_critmin", "unarmed", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_unarmed_range", "repeating_abilities_ability_damage_type"], function(data) {
                
                let rollData = {
                    "bonus": parseInt(data.unarmed) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
                    "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
                    "character_name": data.character_name,
                    "roll_name": data.repeating_abilities_ability_name,
                    "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
                    "brutal_damage": data.repeating_abilities_ability_brutal,
                    "crit_min": data.ability_global_critmin,
                    "damage_type": data.repeating_abilities_ability_damage_type,
                    "is_attack": true,
                    "hidden_roll": data.hidden_roll,
                    "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
                    "attack_type": "Unarmed",
                }
                console.log(rollData); //TPTODO
                _makeRoll(rollData);
            })
        });

        on('clicked:repeating_abilities:effect', function() {
            getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_minimum", "ability_global_damage", "ability_global_critmin", "effect", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_unarmed_range", "repeating_abilities_ability_damage_type"], function(data) {
                
                let rollData = {
                    "bonus": parseInt(data.effect) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
                    "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
                    "character_name": data.character_name,
                    "roll_name": data.repeating_abilities_ability_name,
                    "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
                    "brutal_damage": data.repeating_abilities_ability_brutal,
                    "range": data.repeating_abilities_ability_unarmed_range,
                    "crit_min": data.ability_global_critmin,
                    "damage_type": data.repeating_abilities_ability_damage_type,
                    "is_attack": true,
                    "hidden_roll": data.hidden_roll,
                    "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
                    "attack_type": "Effect",
                }
                console.log(rollData); //TPTODO
                _makeRoll(rollData);
            })
        });

        on('clicked:repeating_abilities:ability', function() {
            getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_minimum", "ability_global_damage", "ability_global_critmin", "ability", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_unarmed_range", "repeating_abilities_ability_damage_type"], function(data) {
                
                let rollData = {
                    "bonus": parseInt(data.ability) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
                    "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
                    "character_name": data.character_name,
                    "roll_name": data.repeating_abilities_ability_name,
                    "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
                    "brutal_damage": data.repeating_abilities_ability_brutal,
                    "range": data.repeating_abilities_ability_unarmed_range,
                    "crit_min": data.ability_global_critmin,
                    "damage_type": data.repeating_abilities_ability_damage_type,
                    "is_attack": true,
                    "hidden_roll": data.hidden_roll,
                    "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
                    "attack_type": "Ability",
                }
                console.log(rollData); //TPTODO
                _makeRoll(rollData);
            })
        });

        on('clicked:repeating_abilities:rune', function() {
            getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_minimum", "ability_global_damage", "ability_global_critmin", "rune", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_unarmed_range", "repeating_abilities_ability_damage_type"], function(data) {
                
                let rollData = {
                    "bonus": parseInt(data.rune) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
                    "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
                    "character_name": data.character_name,
                    "roll_name": data.repeating_abilities_ability_name,
                    "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
                    "brutal_damage": data.repeating_abilities_ability_brutal,
                    "range": data.repeating_abilities_ability_unarmed_range,
                    "crit_min": data.ability_global_critmin,
                    "damage_type": data.repeating_abilities_ability_damage_type,
                    "is_attack": true,
                    "hidden_roll": data.hidden_roll,
                    "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
                    "attack_type": "Rune",
                }
                console.log(rollData); //TPTODO
                _makeRoll(rollData);
            })
        });

        on('clicked:repeating_abilities:environment', function() {
            getAttrs(["character_level", "hidden_roll", "advantage", "modifier", "minimum", "ability_advantage", "ability_accuracy", "ability_minimum", "ability_global_damage", "ability_global_critmin", "environment", "character_name", "repeating_abilities_ability_name", "repeating_abilities_ability_damage", "repeating_abilities_ability_brutal", "repeating_abilities_ability_unarmed_range", "repeating_abilities_ability_damage_type"], function(data) {
                
                let rollData = {
                    "bonus": parseInt(data.environment) + parseInt(data.modifier) + parseInt(data.ability_accuracy),
                    "advantage": parseInt(data.advantage) + parseInt(data.ability_advantage),
                    "character_name": data.character_name,
                    "roll_name": data.repeating_abilities_ability_name,
                    "damage": parseInt(data.repeating_abilities_ability_damage) + parseInt(data.ability_global_damage),
                    "brutal_damage": data.repeating_abilities_ability_brutal,
                    "range": data.repeating_abilities_ability_unarmed_range,
                    "crit_min": data.ability_global_critmin,
                    "damage_type": data.repeating_abilities_ability_damage_type,
                    "is_attack": true,
                    "hidden_roll": data.hidden_roll,
                    "mods_applied": (data.ability_advantage != 0 || data.ability_accuracy != 0 || data.ability_global_damage != 0),
                    "attack_type": "Environment",
                }
                console.log(rollData); //TPTODO
                _makeRoll(rollData);
            })
        });
    
    
    
        on('clicked:repeating_equipment:equip_collapse', function() {
            getAttrs(["repeating_equipment_equipment_collapse"], function(data) {
                console.log(data.repeating_equipment_equipment_collapse);
                setAttrs({
                    repeating_equipment_equipment_collapse: (parseInt(data.repeating_equipment_equipment_collapse) === 1 ? 0 : 1)
                });
            });
        });
    </script>